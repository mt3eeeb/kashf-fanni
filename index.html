<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>

<style>
body{
    font-family: Tahoma, Arial;
    background:#f4f4f4;
    margin:0;
}
.container{
    max-width:900px;
    margin:auto;
    background:#fff;
    padding:12px;
}
.header{
    text-align:center;
    margin-bottom:15px;
}
.header small{
    display:block;
    font-size:13px;
}
h1{margin:5px 0;}

.section{margin-bottom:15px;}
.section h3{
    background:#2ecc71;
    color:#fff;
    padding:7px;
    margin:0 0 8px;
    font-size:15px;
}
.row{
    display:flex;
    gap:5px;
    margin-bottom:5px;
}
input{
    flex:1;
    padding:6px;
    font-size:14px;
}
button{
    padding:8px;
    border:none;
    cursor:pointer;
    font-size:14px;
}
.add{background:#2ecc71;color:#fff;}
.del{background:#e74c3c;color:#fff;}
.gray{background:#ddd;}
.small-btn{width:100%;}
.center{text-align:center;}
.result{
    background:#eee;
    padding:8px;
    font-size:14px;
}

@media print{
    button{display:none;}
    .page-break{page-break-before:always;}
    body{background:#fff;}
}
</style>
</head>

<body>
<div class="container">

<div class="header">
    <small>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§</small>
    <h1>ÙƒØ´Ù ÙÙ†ÙŠ</h1>
</div>

<!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ -->
<div class="section">
<h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<input placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨">
<input type="date">
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
<input placeholder="Lat Ù‚Ø¨Ù„">
<input placeholder="Lat Ø¨Ø¹Ø¯">
<input placeholder="Lng Ù‚Ø¨Ù„">
<input placeholder="Lng Ø¨Ø¹Ø¯">
</div>
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
<input placeholder="Lat Ù‚Ø¨Ù„">
<input placeholder="Lat Ø¨Ø¹Ø¯">
<input placeholder="Lng Ù‚Ø¨Ù„">
<input placeholder="Lng Ø¨Ø¹Ø¯">
</div>
<button class="gray small-btn" onclick="openMaps(this)">ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</button>
</div>

<div class="section">
<h3>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h3>
<div id="corners"></div>
<button class="add small-btn" onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button class="gray small-btn" onclick="calcLandArea()">Ø§Ø­Ø³Ø¨ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø£Ø±Ø¶</button>
<div id="landResult" class="result"></div>
</div>

<div class="page-break"></div>

<!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© -->
<div class="section">
<h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ (Ø§Ù„Ù…Ø­Ø§ÙˆØ±)</h3>
<div id="pivots"></div>
<button class="add small-btn" onclick="addPivot()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø­ÙˆØ±</button>
<button class="gray small-btn" onclick="calcPivots()">Ø§Ø­Ø³Ø¨ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø­Ø§ÙˆØ±</button>
<div id="pivotResult" class="result"></div>
</div>

<div class="section">
<h3>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button class="add small-btn" onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>
</div>

<div class="section">
<h3>Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button class="add small-btn" onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>
</div>

<div class="section">
<h3>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«">
</div>

<div class="section center">
<button class="gray" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

</div>

<script>
/* ---------- Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø© ---------- */
function openMaps(btn){
    let r = btn.previousElementSibling.querySelectorAll("input");
    let lat = r[0].value+"."+r[1].value;
    let lng = r[2].value+"."+r[3].value;
    window.open(`https://www.google.com/maps?q=${lat},${lng}`);
}

/* ---------- Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© ---------- */
function coordRow(){
return `
<div class="row">
<input placeholder="Lat Ù‚Ø¨Ù„">
<input placeholder="Lat Ø¨Ø¹Ø¯">
<input placeholder="Lng Ù‚Ø¨Ù„">
<input placeholder="Lng Ø¨Ø¹Ø¯">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

function addCorner(){
    corners.innerHTML += `<div><b>Ø²Ø§ÙˆÙŠØ© ${corners.children.length+1}</b>${coordRow()}</div>`;
}

function dist(a,b,c,d){
    const R=6371000;
    let dLat=(c-a)*Math.PI/180;
    let dLng=(d-b)*Math.PI/180;
    let x=Math.sin(dLat/2)**2+
    Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*
    Math.sin(dLng/2)**2;
    return R*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));
}

function calcLandArea(){
    let pts=[];
    document.querySelectorAll("#corners .row").forEach(r=>{
        let i=r.querySelectorAll("input");
        pts.push([
            parseFloat(i[0].value+"."+i[1].value),
            parseFloat(i[2].value+"."+i[3].value)
        ]);
    });
    if(pts.length<3){
        landResult.innerHTML="Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„";
        return;
    }

    let txt="";
    for(let i=0;i<pts.length;i++){
        let j=(i+1)%pts.length;
        txt+=`Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø²Ø§ÙˆÙŠØ© ${i+1} Ùˆ ${j+1}: ${dist(
        pts[i][0],pts[i][1],pts[j][0],pts[j][1]
        ).toFixed(1)} Ù…<br>`;
    }

    let area=0;
    for(let i=0;i<pts.length;i++){
        let j=(i+1)%pts.length;
        area+=pts[i][0]*pts[j][1]-pts[j][0]*pts[i][1];
    }
    area=Math.abs(area/2)*111000*111000;

    landResult.innerHTML =
    txt+`<hr>
    Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø£Ø±Ø¶: ${area.toFixed(1)} Ù…Â²<br>
    Ø§Ù„Ù‡ÙƒØªØ§Ø±: ${(area/10000).toFixed(3)}<br>
    Ø§Ù„Ø¯ÙˆÙ†Ù…: ${(area/1000).toFixed(2)}`;
}

/* ---------- Ø§Ù„Ù…Ø­Ø§ÙˆØ± ---------- */
function addPivot(){
    pivots.innerHTML+=`
    <div class="row">
    <input placeholder="Ù†ØµÙ Ø§Ù„Ù‚Ø·Ø± (Ù…)">
    <select>
        <option value="1">Ù…Ø­ÙˆØ± ÙƒØ§Ù…Ù„</option>
        <option value="0.5">Ù†ØµÙ Ù…Ø­ÙˆØ±</option>
        <option value="0.25">Ø±Ø¨Ø¹ Ù…Ø­ÙˆØ±</option>
    </select>
    <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}

function calcPivots(){
    let total=0;
    pivots.querySelectorAll(".row").forEach(r=>{
        let radius=parseFloat(r.children[0].value);
        let factor=parseFloat(r.children[1].value);
        if(radius>0){
            total += Math.PI * radius * radius * factor;
        }
    });
    pivotResult.innerHTML=
    `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø­Ø§ÙˆØ±:<br>
     ${total.toFixed(1)} Ù…Â²<br>
     ${(total/10000).toFixed(3)} Ù‡ÙƒØªØ§Ø±<br>
     ${(total/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…`;
}

/* ---------- Ø£Ø®Ø±Ù‰ ---------- */
function addCrop(){
    crops.innerHTML+=`
    <div class="row">
    <input placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±ÙˆØ¹">
    <input placeholder="Ø§Ù„Ù…Ø³Ø§Ø­Ø©">
    <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}
function addAsset(){
    assets.innerHTML+=`
    <div class="row">
    <input placeholder="Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯">
    <input placeholder="Ø§Ù„ÙˆØµÙ">
    <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}
</script>

</body>
</html>