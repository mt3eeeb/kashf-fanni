<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ Ø²Ø±Ø§Ø¹ÙŠ</title>

<style>
body{font-family:Tahoma;background:#f4f4f4;margin:0}
.container{max-width:900px;margin:auto;background:#fff;padding:12px}
h2{text-align:center}
.section{margin-bottom:15px}
.section h3{background:#2ecc71;color:#fff;padding:7px;margin:0 0 8px}
.row{display:flex;gap:5px;margin-bottom:5px}
input,select{flex:1;padding:6px}
button{padding:6px;border:none;cursor:pointer}
.add{background:#2ecc71;color:#fff}
.del{background:#e74c3c;color:#fff}
.gray{background:#ddd}
.result{background:#eee;padding:8px;font-size:14px}
.small{font-size:12px;color:#555}
@media print{
 button{display:none}
 .page-break{page-break-before:always}
}
</style>
</head>

<body>
<div class="container">

<h2>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§<br>ÙƒØ´Ù ÙÙ†ÙŠ Ø²Ø±Ø§Ø¹ÙŠ</h2>

<!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
<div class="section">
<h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ">
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±Ø¹Ø©">
<input placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨">
<input type="date">
</div>

<!-- Ø²ÙˆØ§ÙŠØ§ -->
<div class="section">
<h3>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h3>
<div id="corners"></div>
<button class="add" onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button class="gray" onclick="calcCorners()">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø·ÙˆØ§Ù„ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©</button>
<div class="result" id="cornerResult"></div>
<div class="small">Ø²Ø± Ø§Ù„Ø¯Ù„ÙŠÙ„Ø© / Ù‚ÙˆÙ‚Ù„ Ù…Ø§Ø¨ Ù„ÙƒÙ„ Ø²Ø§ÙˆÙŠØ©</div>
</div>

<div class="page-break"></div>

<!-- Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ -->
<div class="section">
<h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigation"></div>
<button class="add" onclick="addIrrigation()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>
</div>

<!-- Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª -->
<div class="section">
<h3>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button class="add" onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>
</div>

<!-- Ø£Ø²Ø±Ø§Ø± -->
<div class="section">
<button class="gray" onclick="saveData()">ğŸ’¾ Ø­ÙØ¸</button>
<button class="gray" onclick="clearData()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
<button class="gray" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
</div>

</div>

<script>
/* Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ */
window.onload=()=>{if(localStorage.data)document.body.innerHTML=localStorage.data}
function saveData(){localStorage.data=document.body.innerHTML;alert("ØªÙ… Ø§Ù„Ø­ÙØ¸")}
function clearData(){if(confirm("Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")){localStorage.clear();location.reload()}}

/* Ø®Ø±Ø§Ø¦Ø· */
function openMap(lat,lng){window.open(`https://www.google.com/maps?q=${lat},${lng}`)}
function openDalilah(lat,lng){
  navigator.clipboard.writeText(lat+","+lng);
  alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© â€“ Ø§Ù„ØµÙ‚Ù‡Ø§ ÙÙŠ Ø§Ù„Ø¯Ù„ÙŠÙ„Ø©");
}

/* Ø§Ù„Ø²ÙˆØ§ÙŠØ§ */
function addCorner(){
corners.innerHTML+=`
<div class="row">
<input placeholder="Lat">
<input placeholder="Lng">
<button onclick="openMap(this.previousElementSibling.previousElementSibling.value,this.previousElementSibling.value)">ğŸ—ºï¸</button>
<button onclick="openDalilah(this.previousElementSibling.previousElementSibling.previousElementSibling.value,this.previousElementSibling.previousElementSibling.value)">ğŸ§­</button>
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

function dist(a,b,c,d){
const R=6371000;
let dLat=(c-a)*Math.PI/180;
let dLng=(d-b)*Math.PI/180;
let x=Math.sin(dLat/2)**2+
Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*
Math.sin(dLng/2)**2;
return R*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));
}

function calcCorners(){
let pts=[];
document.querySelectorAll("#corners .row").forEach(r=>{
let i=r.querySelectorAll("input");
if(i[0].value&&i[1].value)pts.push([+i[0].value,+i[1].value]);
});
if(pts.length<3){cornerResult.innerHTML="Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„";return;}

let txt="";
let area=0;
for(let i=0;i<pts.length;i++){
let j=(i+1)%pts.length;
txt+=`Ø§Ù„Ù…Ø³Ø§ÙØ© ${i+1}-${j+1}: ${dist(pts[i][0],pts[i][1],pts[j][0],pts[j][1]).toFixed(1)} Ù…<br>`;
area+=pts[i][0]*pts[j][1]-pts[j][0]*pts[i][1];
}
area=Math.abs(area/2)*111000*111000;
cornerResult.innerHTML=txt+`<hr>
Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${area.toFixed(1)} Ù…Â²<br>
Ù‡ÙƒØªØ§Ø±: ${(area/10000).toFixed(3)}<br>
Ø¯ÙˆÙ†Ù…: ${(area/1000).toFixed(2)}`;
}

/* Ø§Ù„Ø±ÙŠ */
function addIrrigation(){
irrigation.innerHTML+=`
<div class="result">
<input placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬" oninput="calcPivot(this)">
<select>
<option>Ù‚Ù…Ø­</option>
<option>Ø£Ø¹Ù„Ø§Ù Ø®Ø¶Ø±Ø§Ø¡</option>
<option>Ø£Ø®Ø±Ù‰</option>
</select>
<div class="res"></div>
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}
function calcPivot(el){
let n=+el.value;
if(!n)return;
let r=n*50;
let a=Math.PI*r*r;
el.parentElement.querySelector(".res").innerHTML=
`Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…Â²: ${a.toFixed(1)}<br>
Ù‡ÙƒØªØ§Ø±: ${(a/10000).toFixed(2)}<br>
Ø¯ÙˆÙ†Ù…: ${(a/1000).toFixed(1)}`;
}

/* Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª */
function addCrop(){
crops.innerHTML+=`
<div class="row">
<select>
<option>Ù†Ø®ÙŠÙ„</option>
<option>Ù…ØµØ¯Ø§Øª Ø±ÙŠØ§Ø­</option>
<option>Ø­Ù…Ø¶ÙŠØ§Øª</option>
<option>Ø£Ø®Ø±Ù‰</option>
</select>
<input placeholder="Ø§Ù„Ø¹Ø¯Ø¯">
<input placeholder="Ø§Ù„Ù†ÙˆØ¹">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}
</script>
</body>
</html>