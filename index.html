<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ÙƒØ´Ù ÙÙ†ÙŠ Ø²Ø±Ø§Ø¹ÙŠ</title>

<style>
body{
  font-family: Tahoma, Arial;
  background:#f5f5f5;
  margin:0;
  direction:rtl;
}
h2{
  background:#2ecc71;
  color:#fff;
  padding:10px;
  margin:0;
}
.section{
  background:#fff;
  margin:10px;
  border-radius:6px;
  overflow:hidden;
}
.field{
  padding:8px;
}
input, select{
  width:100%;
  padding:8px;
  margin-top:4px;
  box-sizing:border-box;
}
button{
  padding:8px 12px;
  background:#2ecc71;
  border:none;
  color:#fff;
  border-radius:4px;
  cursor:pointer;
}
.btn-red{
  background:#e74c3c;
}
.row{
  display:flex;
  gap:6px;
}
.row > div{
  flex:1;
}
.result{
  padding:8px;
  background:#ecf0f1;
  margin-top:6px;
}
.small{
  font-size:13px;
  color:#555;
}
</style>
</head>

<body>

<!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
<div class="section">
<h2>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h2>
<div class="field"><input id="clientName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„"></div>
<div class="field"><input id="orderNo" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨"></div>
<div class="field"><input type="date" id="visitDate"></div>
</div>

<!-- Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø³Ø¬Ù„ -->
<div class="section">
<h2>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø³Ø¬Ù„</h2>
<div class="field row">
  <div><input id="recordLat" placeholder="Latitude"></div>
  <div><input id="recordLng" placeholder="Longitude"></div>
</div>
<div class="field">
<button onclick="openMaps('recordLat','recordLng')">ÙØªØ­ Ù‚ÙˆÙ‚Ù„ Ù…Ø§Ø¨</button>
<button onclick="openDalilah('recordLat','recordLng')">ÙØªØ­ Ø§Ù„Ø¯Ù„ÙŠÙ„Ø©</button>
</div>
</div>

<!-- Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© -->
<div class="section">
<h2>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h2>
<div class="field row">
  <div><input id="gateLat" placeholder="Latitude"></div>
  <div><input id="gateLng" placeholder="Longitude"></div>
</div>
<div class="field">
<button onclick="openMaps('gateLat','gateLng')">ÙØªØ­ Ù‚ÙˆÙ‚Ù„ Ù…Ø§Ø¨</button>
<button onclick="openDalilah('gateLat','gateLng')">ÙØªØ­ Ø§Ù„Ø¯Ù„ÙŠÙ„Ø©</button>
</div>
</div>

<!-- Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© -->
<div class="section">
<h2>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© (Ø­Ø³Ø¨ Ø§Ù„ÙƒØ±ÙˆÙƒÙŠ)</h2>
<div id="points"></div>
<div class="field">
<button onclick="addPoint()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button onclick="calcArea()">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø·ÙˆØ§Ù„ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©</button>
</div>
<div id="areaResult" class="result"></div>
</div>

<!-- Ø§Ù„Ø¢Ø¨Ø§Ø± -->
<div class="section">
<h2>Ø§Ù„Ø¢Ø¨Ø§Ø±</h2>
<div id="wells"></div>
<div class="field">
<button onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
</div>
</div>

<!-- Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ -->
<div class="section">
<h2>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h2>
<div id="irrigation"></div>
<div class="field">
<button onclick="addIrrigation()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>
</div>
</div>

<!-- Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª -->
<div class="section">
<h2>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h2>
<div id="crops"></div>
<div class="field">
<button onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹Ø§Øª</button>
</div>
</div>

<!-- Ø­ÙØ¸ -->
<div class="section">
<div class="field">
<button onclick="saveData()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
<button class="btn-red" onclick="clearData()">ğŸ—‘ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>
</div>
</div>

<script>
/* Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ */
window.onload = ()=>{
  const data = localStorage.getItem("farmForm");
  if(data){
    document.body.innerHTML = data;
  }
};

/* Ø­ÙØ¸ */
function saveData(){
  localStorage.setItem("farmForm", document.body.innerHTML);
  alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ âœ”");
}
function clearData(){
  if(confirm("Ù…ØªØ£ÙƒØ¯ØŸ")){
    localStorage.removeItem("farmForm");
    location.reload();
  }
}

/* Ø®Ø±Ø§Ø¦Ø· */
function openMaps(lat,lng){
  const la=document.getElementById(lat).value;
  const ln=document.getElementById(lng).value;
  if(!la||!ln){alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª");return;}
  window.open(`https://www.google.com/maps?q=${la},${ln}`);
}
function openDalilah(lat,lng){
  const la=document.getElementById(lat).value;
  const ln=document.getElementById(lng).value;
  if(!la||!ln){alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª");return;}
  window.open(`dalilah://map?lat=${la}&lng=${ln}`);
}

/* Ø²ÙˆØ§ÙŠØ§ */
function addPoint(){
  const d=document.createElement("div");
  d.className="field row";
  d.innerHTML=`
    <div><input placeholder="Latitude"></div>
    <div><input placeholder="Longitude"></div>
  `;
  document.getElementById("points").appendChild(d);
}

/* Ø­Ø³Ø§Ø¨ Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙƒØ±ÙˆÙƒÙŠ */
function calcArea(){
  const pts=[...document.querySelectorAll("#points .row")];
  if(pts.length<3){alert("Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");return;}

  let coords=[];
  pts.forEach(p=>{
    const lat=parseFloat(p.children[0].children[0].value);
    const lng=parseFloat(p.children[1].children[0].value);
    coords.push([lng,lat]);
  });

  let area=0;
  for(let i=0;i<coords.length;i++){
    let j=(i+1)%coords.length;
    area+=coords[i][0]*coords[j][1];
    area-=coords[j][0]*coords[i][1];
  }
  area=Math.abs(area/2)*111139*111139;

  document.getElementById("areaResult").innerHTML=`
  Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…Â²: ${area.toFixed(2)}<br>
  Ù‡ÙƒØªØ§Ø±: ${(area/10000).toFixed(2)}<br>
  Ø¯ÙˆÙ†Ù…: ${(area/1000).toFixed(2)}
  `;
}

/* Ø¢Ø¨Ø§Ø± */
function addWell(){
  const d=document.createElement("div");
  d.className="field row";
  d.innerHTML=`
    <div><input placeholder="Latitude"></div>
    <div><input placeholder="Longitude"></div>
    <div>
      <button onclick="openMaps(this.parentNode.parentNode.children[0].children[0].id,
      this.parentNode.parentNode.children[1].children[0].id)">ğŸ“</button>
    </div>
  `;
  document.getElementById("wells").appendChild(d);
}

/* Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ */
function addIrrigation(){
  const d=document.createElement("div");
  d.className="field";
  d.innerHTML=`
  <select>
    <option>Ø±Ø´Ø§Ø´ Ù…Ø­ÙˆØ±ÙŠ</option>
    <option>ØªÙ†Ù‚ÙŠØ·</option>
    <option>ØºÙ…Ø±</option>
  </select>
  <input type="number" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬">
  <div class="small">Ø·ÙˆÙ„ Ø§Ù„Ø¨Ø±Ø¬ Ø«Ø§Ø¨Øª = 50 Ù…</div>
  `;
  document.getElementById("irrigation").appendChild(d);
}

/* Ù…Ø²Ø±ÙˆØ¹Ø§Øª */
function addCrop(){
  const d=document.createElement("div");
  d.className="field";
  d.innerHTML=`
  <select>
    <option>Ù‚Ù…Ø­</option>
    <option>Ø£Ø¹Ù„Ø§Ù Ø®Ø¶Ø±Ø§Ø¡</option>
    <option>Ù†Ø®ÙŠÙ„</option>
    <option>Ø­Ù…Ø¶ÙŠØ§Øª</option>
    <option>Ø£Ø®Ø±Ù‰</option>
  </select>
  <input placeholder="Ø§Ù„Ø¹Ø¯Ø¯">
  <input placeholder="Ø§Ù„Ù†ÙˆØ¹">
  `;
  document.getElementById("crops").appendChild(d);
}
</script>

</body>
</html>