<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>

<style>
body{
  font-family: Tahoma;
  background:#f2f6f3;
  margin:0;
  padding:20px;
}
h1,h2{
  text-align:center;
  margin:5px 0;
}
h1{color:#1e8449}
h2{color:#145a32}

.section{
  background:#fff;
  border:1px solid #cce5d6;
  border-radius:6px;
  margin-bottom:15px;
  padding:12px;
}
.section h3{
  background:#27ae60;
  color:#fff;
  margin:-12px -12px 10px -12px;
  padding:8px;
  font-size:15px;
}

.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.field{
  flex:1;
  min-width:150px;
}
label{font-size:13px}
input,select,textarea{
  width:100%;
  padding:6px;
  margin-top:3px;
  box-sizing:border-box;
}
button{
  padding:6px 10px;
  background:#27ae60;
  color:#fff;
  border:none;
  border-radius:4px;
  cursor:pointer;
}
button.red{background:#c0392b}
button.gray{background:#7f8c8d}
.small{font-size:12px;color:#555}

.box{
  border:1px dashed #ccc;
  padding:8px;
  margin-bottom:8px;
}

/* ===== Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ===== */
@media print{
  .no-print{display:none}
  .page-break{page-break-before:always}
}
</style>
</head>

<body>

<h1>ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</h1>
<h2>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§</h2>
<h2>ÙƒØ´Ù ÙÙ†ÙŠ</h2>

<!-- 1 Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© -->
<div class="section">
<h3>1ï¸âƒ£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<div class="row">
  <div class="field">
    <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
    <input id="clientName">
  </div>
  <div class="field">
    <label>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label>
    <input id="orderNo">
  </div>
  <div class="field">
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
    <input type="date" id="visitDate">
  </div>
</div>
</div>

<!-- 2 Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„ -->
<div class="section">
<h3>2ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
  <div class="field"><input id="recLat" placeholder="Latitude"></div>
  <div class="field"><input id="recLng" placeholder="Longitude"></div>
</div>
<button onclick="openMap('recLat','recLng')">ğŸ—ºï¸ Ø§Ù„ÙˆØµÙˆÙ„</button>
</div>

<!-- 3 Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© -->
<div class="section">
<h3>3ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
  <div class="field"><input id="gateLat" placeholder="Latitude"></div>
  <div class="field"><input id="gateLng" placeholder="Longitude"></div>
</div>
<button onclick="getLocation('gateLat','gateLng')">ğŸ“ ØªØ­Ø¯ÙŠØ¯</button>
<button onclick="openMap('gateLat','gateLng')">ğŸ—ºï¸ ÙˆØµÙˆÙ„</button>
</div>

<!-- 4 Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© -->
<div class="section">
<h3>4ï¸âƒ£ Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h3>
<div id="corners"></div>
<button onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button onclick="calcCorners()">Ø­Ø³Ø§Ø¨</button>
<div id="cornerResult" class="small"></div>
</div>

<div class="page-break"></div>

<!-- 5 Ø§Ù„Ø¢Ø¨Ø§Ø± -->
<div class="section">
<h3>5ï¸âƒ£ Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells"></div>
<button onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
</div>

<!-- 6 Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ -->
<div class="section">
<h3>6ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigation"></div>
<button onclick="addIrr()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù…</button>
</div>

<!-- 7 Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª -->
<div class="section">
<h3>7ï¸âƒ£ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="plants"></div>
<button onclick="addPlant()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>
</div>

<!-- 8 Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª -->
<div class="section">
<h3>8ï¸âƒ£ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>
</div>

<!-- 9 Ø§Ù„Ø¨Ø§Ø­Ø« -->
<div class="section">
<h3>9ï¸âƒ£ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input id="researcher">
</div>

<div class="no-print">
<button onclick="saveAll()">ğŸ’¾ Ø­ÙØ¸</button>
<button class="red" onclick="clearAll()">ğŸ—‘ï¸ Ø­Ø°Ù</button>
<button class="gray" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

<script>
/* ===== Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø© ===== */
function openMap(latId,lngId){
  const lat=document.getElementById(latId).value;
  const lng=document.getElementById(lngId).value;
  if(!lat||!lng) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª");
  window.open(`https://www.google.com/maps?q=${lat},${lng}`);
}
function getLocation(latId,lngId){
  navigator.geolocation.getCurrentPosition(p=>{
    document.getElementById(latId).value=p.coords.latitude.toFixed(6);
    document.getElementById(lngId).value=p.coords.longitude.toFixed(6);
  });
}

/* ===== Ø§Ù„ØªØ®Ø²ÙŠÙ† ===== */
function saveAll(){
  document.querySelectorAll("input,select,textarea").forEach(e=>{
    localStorage.setItem(e.id,e.value);
  });
  localStorage.setItem("corners",JSON.stringify(corners));
  localStorage.setItem("wells",JSON.stringify(wells));
  localStorage.setItem("irrs",JSON.stringify(irrs));
  localStorage.setItem("plants",JSON.stringify(plants));
  localStorage.setItem("assets",JSON.stringify(assets));
  alert("ØªÙ… Ø§Ù„Ø­ÙØ¸");
}
function loadAll(){
  document.querySelectorAll("input,select,textarea").forEach(e=>{
    if(localStorage.getItem(e.id)) e.value=localStorage.getItem(e.id);
  });
}
function clearAll(){
  if(confirm("Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ")){
    localStorage.clear();
    location.reload();
  }
}

/* ===== 4 Ø§Ù„Ø²ÙˆØ§ÙŠØ§ ===== */
let corners=JSON.parse(localStorage.getItem("corners"))||[];
function addCorner(lat="",lng=""){
  corners.push({lat,lng});
  drawCorners();
}
function drawCorners(){
  const c=document.getElementById("corners");
  c.innerHTML="";
  corners.forEach((p,i)=>{
    c.innerHTML+=`
    <div class="box">
      <input value="${p.lat}" oninput="corners[${i}].lat=this.value">
      <input value="${p.lng}" oninput="corners[${i}].lng=this.value">
      <button class="red" onclick="corners.splice(${i},1);drawCorners()">âˆ’</button>
    </div>`;
  });
}
function dist(a,b){
  const R=6371000;
  const dLat=(b.lat-a.lat)*Math.PI/180;
  const dLng=(b.lng-a.lng)*Math.PI/180;
  const x=Math.sin(dLat/2)**2+
  Math.cos(a.lat*Math.PI/180)*Math.cos(b.lat*Math.PI/180)*Math.sin(dLng/2)**2;
  return 2*R*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));
}
function calcCorners(){
  if(corners.length<3)return;
  let area=0,txt="";
  for(let i=0;i<corners.length;i++){
    const a=corners[i],b=corners[(i+1)%corners.length];
    txt+=`Ø¶Ù„Ø¹ ${i+1}: ${dist(a,b).toFixed(2)} Ù…<br>`;
    area+=a.lng*b.lat-b.lng*a.lat;
  }
  area=Math.abs(area/2)*111139*111139;
  document.getElementById("cornerResult").innerHTML=
  txt+`<b>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</b> ${area.toFixed(0)} Ù…Â² | ${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø± | ${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…`;
}

/* ===== 5 Ø§Ù„Ø¢Ø¨Ø§Ø± ===== */
let wells=JSON.parse(localStorage.getItem("wells"))||[];
function addWell(){wells.push({lat:"",lng:""});drawWells();}
function drawWells(){
  const c=document.getElementById("wells");c.innerHTML="";
  wells.forEach((w,i)=>{
    c.innerHTML+=`
    <div class="box">
      <input value="${w.lat}" oninput="wells[${i}].lat=this.value">
      <input value="${w.lng}" oninput="wells[${i}].lng=this.value">
      <button onclick="getLocationWell(${i})">ğŸ“</button>
      <button onclick="openWell(${i})">ğŸ—ºï¸</button>
      <button class="red" onclick="wells.splice(${i},1);drawWells()">âˆ’</button>
    </div>`;
  });
}
function getLocationWell(i){
  navigator.geolocation.getCurrentPosition(p=>{
    wells[i].lat=p.coords.latitude.toFixed(6);
    wells[i].lng=p.coords.longitude.toFixed(6);
    drawWells();
  });
}
function openWell(i){
  window.open(`https://www.google.com/maps?q=${wells[i].lat},${wells[i].lng}`);
}

/* ===== 6 Ø§Ù„Ø±ÙŠ ===== */
let irrs=JSON.parse(localStorage.getItem("irrs"))||[];
function addIrr(){irrs.push({type:"",a:0,b:0});drawIrr();}
function drawIrr(){
  const c=document.getElementById("irrigation");c.innerHTML="";
  irrs.forEach((r,i)=>{
    let area=0;
    if(r.type=="Ø±Ø´Ø§Ø´")area=r.a*r.b;
    if(r.type=="ØªÙ†Ù‚ÙŠØ·")area=r.a;
    if(r.type=="ØºÙ…Ø±")area=r.a;
    c.innerHTML+=`
    <div class="box">
      <select onchange="irrs[${i}].type=this.value;drawIrr()">
        <option></option>
        <option ${r.type=="Ø±Ø´Ø§Ø´"?"selected":""}>Ø±Ø´Ø§Ø´</option>
        <option ${r.type=="ØªÙ†Ù‚ÙŠØ·"?"selected":""}>ØªÙ†Ù‚ÙŠØ·</option>
        <option ${r.type=="ØºÙ…Ø±"?"selected":""}>ØºÙ…Ø±</option>
      </select>
      ${r.type=="Ø±Ø´Ø§Ø´"?`
      Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬<input type="number" oninput="irrs[${i}].a=this.value">
      Ø·ÙˆÙ„ Ø§Ù„Ø¨Ø±Ø¬<input type="number" oninput="irrs[${i}].b=this.value">
      `:""}
      ${r.type!="Ø±Ø´Ø§Ø´"&&r.type?`
      Ø§Ù„Ù…Ø³Ø§Ø­Ø©<input type="number" oninput="irrs[${i}].a=this.value">
      `:""}
      <div class="small">
      ${area} Ù…Â² | ${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø± | ${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…
      </div>
      <button class="red" onclick="irrs.splice(${i},1);drawIrr()">âˆ’</button>
    </div>`;
  });
}

/* ===== 7 Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª ===== */
let plants=JSON.parse(localStorage.getItem("plants"))||[];
function addPlant(){plants.push({n:0});drawPlants();}
function drawPlants(){
  const c=document.getElementById("plants");c.innerHTML="";
  plants.forEach((p,i)=>{
    const area=p.n*10;
    c.innerHTML+=`
    <div class="box">
      Ø¹Ø¯Ø¯ Ø§Ù„Ø´ØªÙ„Ø§Øª
      <input type="number" oninput="plants[${i}].n=this.value">
      <div class="small">
      ${area} Ù…Â² | ${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø± | ${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…
      </div>
      <button class="red" onclick="plants.splice(${i},1);drawPlants()">âˆ’</button>
    </div>`;
  });
}

/* ===== 8 Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª ===== */
let assets=JSON.parse(localStorage.getItem("assets"))||[];
function addAsset(){assets.push({d:"",n:""});drawAssets();}
function drawAssets(){
  const c=document.getElementById("assets");c.innerHTML="";
  assets.forEach((a,i)=>{
    c.innerHTML+=`
    <div class="box">
      Ø§Ù„ÙˆØµÙ<input oninput="assets[${i}].d=this.value">
      Ø§Ù„Ø¹Ø¯Ø¯<input type="number" oninput="assets[${i}].n=this.value">
      <button class="red" onclick="assets.splice(${i},1);drawAssets()">âˆ’</button>
    </div>`;
  });
}

/* ØªØ­Ù…ÙŠÙ„ */
loadAll();drawCorners();drawWells();drawIrr();drawPlants();drawAssets();
</script>

</body>
</html>