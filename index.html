<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>

<style>
body{font-family:Tahama,Arial;background:#f4f4f4;margin:0}
.container{max-width:900px;margin:auto;background:#fff;padding:12px}
h3{background:#2ecc71;color:#fff;padding:6px;margin:10px 0}
.row{display:flex;gap:5px;margin-bottom:5px}
input,select{flex:1;padding:6px;font-size:13px}
button{padding:6px;border:none;cursor:pointer}
.add{background:#2ecc71;color:#fff}
.del{background:#e74c3c;color:#fff}
.gray{background:#ddd}
.small{width:100%}
.result{background:#eee;padding:6px;font-size:13px}
.center{text-align:center}

@media print{
button{display:none}
.page-break{page-break-before:always}
body{font-size:11px}
}
</style>
</head>

<body>
<div class="container">

<h2 class="center">ÙƒØ´Ù ÙÙ†ÙŠ</h2>

<h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<div class="row">
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<input placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨">
<input type="date">
</div>

<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
<input placeholder="Longitude">
<input placeholder="Latitude">
<button class="gray" onclick="openMap(this)">Ø®Ø±ÙŠØ·Ø©</button>
</div>

<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
<input placeholder="Longitude">
<input placeholder="Latitude">
<button class="gray" onclick="getLocation(this)">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
<button class="gray" onclick="openMap(this)">Ø®Ø±ÙŠØ·Ø©</button>
</div>

<h3>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ø£Ø±Ø¶ (Ø­Ø³Ø¨ Ø§Ù„ÙƒØ±ÙˆÙƒÙŠ)</h3>
<div id="corners"></div>
<button class="add small" onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button class="gray small" onclick="calcLand()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø©</button>
<div id="landResult" class="result"></div>

<div class="page-break"></div>

<h3>Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells"></div>
<button class="add small" onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>

<h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigation"></div>
<button class="add small" onclick="addIrrigation()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>

<h3>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button class="add small" onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>

<h3>Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button class="add small" onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>

<h3>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«">

<div class="center">
<button class="gray" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

</div>

<script>
// ------------------ Ø£Ø¯ÙˆØ§Øª ------------------
function openMap(btn){
let r=btn.parentElement.querySelectorAll("input");
window.open(`https://maps.google.com/?q=${r[1].value},${r[0].value}`);
}

function getLocation(btn){
navigator.geolocation.getCurrentPosition(p=>{
let r=btn.parentElement.querySelectorAll("input");
r[0].value=p.coords.longitude.toFixed(6);
r[1].value=p.coords.latitude.toFixed(6);
});
}

// ------------------ ØªØ­ÙˆÙŠÙ„ UTM Zone 38N ------------------
function toUTM(lat,lon){
const a=6378137,f=1/298.257223563,k0=0.9996;
const zone=38,Î»0=(zone*6-183)*Math.PI/180;
lat*=Math.PI/180;lon*=Math.PI/180;
let e=Math.sqrt(f*(2-f));
let N=a/Math.sqrt(1-e*e*Math.sin(lat)**2);
let T=Math.tan(lat)**2;
let C=(e*e/(1-e*e))*Math.cos(lat)**2;
let A=(lon-Î»0)*Math.cos(lat);
let M=a*((1-e*e/4-3*e**4/64-5*e**6/256)*lat
-(3*e*e/8+3*e**4/32+45*e**6/1024)*Math.sin(2*lat));
let x=k0*N*(A+(1-T+C)*A**3/6)+500000;
let y=k0*(M+N*Math.tan(lat)*(A*A/2));
return [x,y];
}

// ------------------ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ ------------------
function addCorner(){
corners.innerHTML+=`
<div class="row">
<input placeholder="Longitude">
<input placeholder="Latitude">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

// ------------------ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø±Ø¶ ------------------
function calcLand(){
let pts=[];
document.querySelectorAll("#corners .row").forEach(r=>{
let i=r.querySelectorAll("input");
if(i[0].value&&i[1].value){
pts.push(toUTM(+i[1].value,+i[0].value));
}
});
if(pts.length<3){landResult.innerHTML="Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„";return;}

let txt="",area=0;
for(let i=0;i<pts.length;i++){
let j=(i+1)%pts.length;
let dx=pts[i][0]-pts[j][0],dy=pts[i][1]-pts[j][1];
txt+=`Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø²Ø§ÙˆÙŠØ© ${i+1} Ùˆ ${j+1}: ${Math.hypot(dx,dy).toFixed(2)} Ù…<br>`;
area+=pts[i][0]*pts[j][1]-pts[j][0]*pts[i][1];
}
area=Math.abs(area/2);

landResult.innerHTML=txt+`<hr>
<b>Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø£Ø±Ø¶:</b><br>
${area.toFixed(2)} Ù…Â²<br>
${(area/10000).toFixed(3)} Ù‡ÙƒØªØ§Ø±<br>
${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…`;
}

// ------------------ Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¹Ù†Ø§ØµØ± ------------------
function addWell(){
wells.innerHTML+=`
<div class="row">
<input placeholder="Longitude">
<input placeholder="Latitude">
<button class="gray" onclick="openMap(this)">Ø®Ø±ÙŠØ·Ø©</button>
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

function addIrrigation(){
irrigation.innerHTML+=`
<div class="row">
<select><option>Ù…Ø­ÙˆØ±ÙŠ</option><option>Ø±Ø´</option></select>
<input placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆØ±">
<input placeholder="Ø§Ù„Ù…Ø²Ø±ÙˆØ¹">
<input placeholder="Ø£Ø®Ø±Ù‰">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

function addCrop(){
crops.innerHTML+=`
<div class="row">
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±ÙˆØ¹">
<input placeholder="Ø§Ù„Ù…Ø³Ø§Ø­Ø©">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

function addAsset(){
assets.innerHTML+=`
<div class="row">
<input placeholder="Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯">
<input placeholder="Ø§Ù„ÙˆØµÙ">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}
</script>
</body>
</html>