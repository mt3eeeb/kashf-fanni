<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¯ 5</title>
<style>
body { font-family: Tahoma; padding:20px }
button { margin:2px }
</style>
</head>

<body>

<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>

<div id="wellsContainer"></div>

<button onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>

<script>
let wells = [];

// ØªØ­Ù…ÙŠÙ„
window.onload = function () {
  const saved = localStorage.getItem("wells_test");
  wells = saved ? JSON.parse(saved) : [];
  renderWells();
};

function saveWells() {
  localStorage.setItem("wells_test", JSON.stringify(wells));
}

function addWell() {
  wells.push({ lat:"", lng:"" });
  saveWells();
  renderWells();
}

function removeWell(i) {
  wells.splice(i,1);
  saveWells();
  renderWells();
}

function updateWell(i, f, v) {
  wells[i][f] = v;
  saveWells();
}

function locateWell(i) {
  navigator.geolocation.getCurrentPosition(p=>{
    wells[i].lat = p.coords.latitude.toFixed(6);
    wells[i].lng = p.coords.longitude.toFixed(6);
    saveWells();
    renderWells();
  });
}

function openWellMap(i) {
  const w = wells[i];
  if(!w.lat||!w.lng){ alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª"); return; }
  window.open(`https://www.google.com/maps?q=${w.lat},${w.lng}`);
}

function renderWells() {
  const c = document.getElementById("wellsContainer");
  c.innerHTML = "";
  wells.forEach((w,i)=>{
    c.innerHTML += `
      <div>
        Lat <input value="${w.lat}" oninput="updateWell(${i},'lat',this.value)">
        Lng <input value="${w.lng}" oninput="updateWell(${i},'lng',this.value)">
        <button onclick="locateWell(${i})">ğŸ“</button>
        <button onclick="openWellMap(${i})">ğŸ—ºï¸</button>
        <button onclick="removeWell(${i})">âˆ’</button>
      </div>
    `;
  });
}
</script>

</body>
</html>