<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>

<style>
body{
    font-family: Tahoma, Arial;
    background:#f4f4f4;
    margin:0;
}
.container{
    max-width:900px;
    margin:auto;
    background:#fff;
    padding:15px;
}
.header{text-align:center;margin-bottom:20px;}
.header small{display:block;font-size:13px;margin-bottom:5px;}

.section{margin-bottom:20px;}
.section h3{
    background:#2ecc71;
    color:#fff;
    padding:8px;
    margin:0 0 10px;
}

.row{display:flex;gap:5px;margin-bottom:5px;}
input{flex:1;padding:6px;font-size:14px;}
button{padding:8px;border:none;cursor:pointer;font-size:14px;}
.add{background:#2ecc71;color:#fff;}
.del{background:#e74c3c;color:#fff;}
.gray{background:#ddd;}
.small-btn{width:100%;}
.center{text-align:center;}

.result{
    background:#eee;
    padding:8px;
    page-break-inside:avoid;
    font-size:14px;
}

.notice{
    background:#fff3cd;
    padding:8px;
    border:1px solid #ffeeba;
    font-size:13px;
}

@media print{
  button{display:none;}
  .page-break{page-break-before:always;}
  body{background:#fff;}
}
</style>
</head>

<body>
<div class="container">

<div class="header">
    <small>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§</small>
    <h1>ÙƒØ´Ù ÙÙ†ÙŠ</h1>
</div>

<!-- Ø§Ù„ØµÙØ­Ø© 1 -->
<div class="section">
<h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<input placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨">
<input type="date">
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
<input placeholder="Lat">
<input placeholder="Lng">
</div>
<button class="gray small-btn" onclick="openMapRow(this)">ÙØªØ­ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</button>
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
<input placeholder="Lat">
<input placeholder="Lng">
</div>
<button class="gray small-btn" onclick="getLocation(this)">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
<button class="gray small-btn" onclick="openMapRow(this)">ÙØªØ­ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</button>
</div>

<div class="section">
<h3>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© (Ù„Ù„ÙØ­Øµ ÙÙ‚Ø·)</h3>
<div id="corners"></div>
<button class="add small-btn" onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button class="gray small-btn" onclick="calcCorners()">ÙØ­Øµ Ø§Ù„Ø²ÙˆØ§ÙŠØ§</button>
<div id="cornerResult" class="result"></div>
</div>

<div class="section">
<h3>Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© (Ø­Ø³Ø¨ Ø§Ù„ÙƒØ±ÙˆÙƒÙŠ)</h3>
<div class="notice">
âš ï¸ Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© Ø±Ø³Ù…ÙŠÙ‹Ø§
</div>
<input id="crokiArea" placeholder="Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø¨Ø§Ù„Ù…ØªØ± Ø§Ù„Ù…Ø±Ø¨Ø¹">
<div class="result" id="crokiResult"></div>
</div>

<div class="page-break"></div>

<!-- Ø§Ù„ØµÙØ­Ø© 2 -->
<div class="section">
<h3>Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells"></div>
<button class="add small-btn" onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
</div>

<div class="section">
<h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigation"></div>
<button class="add small-btn" onclick="addIrrigation()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>
</div>

<div class="section">
<h3>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button class="add small-btn" onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>
</div>

<div class="section">
<h3>Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button class="add small-btn" onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>
</div>

<div class="section">
<h3>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«">
</div>

<div class="section center">
<button class="gray" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

</div>

<script>
// ===== Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø© =====
function openMapRow(btn){
    let r=btn.previousElementSibling.querySelectorAll("input");
    let lat=r[0].value;
    let lng=r[1].value;
    if(lat && lng){
        window.open(`https://www.google.com/maps?q=${lat},${lng}`);
    }else{
        alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹");
    }
}

function getLocation(btn){
    navigator.geolocation.getCurrentPosition(pos=>{
        let r=btn.previousElementSibling.querySelectorAll("input");
        r[0].value=pos.coords.latitude.toFixed(6);
        r[1].value=pos.coords.longitude.toFixed(6);
    });
}

// ===== Ø§Ù„Ø²ÙˆØ§ÙŠØ§ =====
function addCorner(){
    corners.innerHTML+=`
    <div class="row">
        <input placeholder="Lat">
        <input placeholder="Lng">
        <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}

function distance(a,b,c,d){
    const R=6371000;
    let dLat=(c-a)*Math.PI/180;
    let dLng=(d-b)*Math.PI/180;
    let x=Math.sin(dLat/2)**2+
    Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*
    Math.sin(dLng/2)**2;
    return R*2*Math.atan2(Math.sqrt(x),Math.sqrt(1-x));
}

function calcCorners(){
    let pts=[];
    document.querySelectorAll("#corners .row").forEach(r=>{
        let i=r.querySelectorAll("input");
        if(i[0].value && i[1].value){
            pts.push([parseFloat(i[0].value),parseFloat(i[1].value)]);
        }
    });

    if(pts.length<3){
        cornerResult.innerHTML="Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„";
        return;
    }

    let txt="";
    for(let i=0;i<pts.length;i++){
        let j=(i+1)%pts.length;
        txt+=`Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø²Ø§ÙˆÙŠØ© ${i+1} Ùˆ ${j+1}: 
        ${distance(
            pts[i][0],pts[i][1],
            pts[j][0],pts[j][1]
        ).toFixed(1)} Ù…<br>`;
    }

    cornerResult.innerHTML=txt+
    "<hr>ğŸ” Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª Ù„Ù„ÙØ­Øµ ÙÙ‚Ø· ÙˆÙ„ÙŠØ³Øª Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ©";
}

// ===== Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª =====
function addWell(){
    wells.innerHTML+=`
    <div class="row">
        <input placeholder="Lat">
        <input placeholder="Lng">
        <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}
function addIrrigation(){
    irrigation.innerHTML+=`
    <div class="row">
        <input placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø±ÙŠ">
        <input placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆØ±">
        <input placeholder="Ø§Ù„Ù…Ø²Ø±ÙˆØ¹">
        <input placeholder="Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø±ÙŠ">
        <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}
function addCrop(){
    crops.innerHTML+=`
    <div class="row">
        <input placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±ÙˆØ¹">
        <input placeholder="Ø§Ù„Ù…Ø³Ø§Ø­Ø©">
        <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}
function addAsset(){
    assets.innerHTML+=`
    <div class="row">
        <input placeholder="Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯">
        <input placeholder="Ø§Ù„ÙˆØµÙ">
        <button class="del" onclick="this.parentElement.remove()">âˆ’</button>
    </div>`;
}

// ===== Ù…Ø³Ø§Ø­Ø© Ø§Ù„ÙƒØ±ÙˆÙƒÙŠ =====
document.getElementById("crokiArea").addEventListener("input",()=>{
    let v=parseFloat(crokiArea.value);
    if(v){
        crokiResult.innerHTML=
        `Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${v.toFixed(1)} Ù…Â²<br>
        Ø§Ù„Ù‡ÙƒØªØ§Ø±: ${(v/10000).toFixed(3)}<br>
        Ø§Ù„Ø¯ÙˆÙ†Ù…: ${(v/1000).toFixed(2)}`;
    }else{
        crokiResult.innerHTML="";
    }
});
</script>

</body>
</html>