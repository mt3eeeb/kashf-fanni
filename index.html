<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>

<style>
body{
    font-family: Tahoma, Arial;
    background:#f4f4f4;
    margin:0;
}
.container{
    max-width:900px;
    margin:auto;
    background:#fff;
    padding:12px;
}
.header{text-align:center;margin-bottom:15px;}
.header small{display:block;font-size:13px;}
.section{margin-bottom:14px;}
.section h3{
    background:#2ecc71;
    color:#fff;
    padding:6px;
    margin:0 0 8px;
    font-size:15px;
}
.row{
    display:flex;
    gap:4px;
    margin-bottom:4px;
}
input{
    flex:1;
    padding:5px;
    font-size:13px;
}
button{
    padding:7px;
    border:none;
    cursor:pointer;
    font-size:13px;
}
.add{background:#2ecc71;color:#fff;}
.del{background:#e74c3c;color:#fff;}
.gray{background:#ddd;}
.small-btn{width:100%;}
.center{text-align:center;}
.result{
    background:#eee;
    padding:8px;
    font-size:13px;
    page-break-inside:avoid;
}

.bad-corner input{
    background:#ffe6e6;
    border:1px solid #e74c3c;
}
.good-corner input{
    background:#eaffea;
}

@media print{
    body{background:#fff;}
    button{display:none;}
    .page-break{page-break-before:always;}
    input{font-size:11px;}
    h1{font-size:18px;}
    h3{font-size:14px;}
}
</style>
</head>

<body>
<div class="container">

<!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
<div class="header">
    <small>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§</small>
    <h1>ÙƒØ´Ù ÙÙ†ÙŠ</h1>
</div>

<!-- Ø§Ù„ØµÙØ­Ø© 1 -->
<div class="section">
<h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<input placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨">
<input type="date">
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
<input placeholder="Lat Ù‚Ø¨Ù„">
<input placeholder="Lat Ø¨Ø¹Ø¯">
<input placeholder="Lng Ù‚Ø¨Ù„">
<input placeholder="Lng Ø¨Ø¹Ø¯">
</div>
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
<input placeholder="Lat Ù‚Ø¨Ù„">
<input placeholder="Lat Ø¨Ø¹Ø¯">
<input placeholder="Lng Ù‚Ø¨Ù„">
<input placeholder="Lng Ø¨Ø¹Ø¯">
</div>
</div>

<div class="section">
<h3>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h3>
<div id="corners"></div>
<button class="add small-btn" onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button class="gray small-btn" onclick="checkCorners()">ÙØ­Øµ Ø§Ù„Ø²ÙˆØ§ÙŠØ§</button>
<button class="gray small-btn" onclick="calcArea()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø©</button>
<div id="areaResult" class="result"></div>
</div>

<div class="page-break"></div>

<!-- Ø§Ù„ØµÙØ­Ø© 2 -->
<div class="section">
<h3>Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells"></div>
<button class="add small-btn" onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
</div>

<div class="section">
<h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigation"></div>
<button class="add small-btn" onclick="addIrrigation()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>
</div>

<div class="section">
<h3>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button class="add small-btn" onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>
</div>

<div class="section">
<h3>Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button class="add small-btn" onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>
</div>

<div class="section">
<h3>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«">
</div>

<div class="section center">
<button class="gray" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

</div>

<script>
function coordRow(){
return `
<div class="row">
<input placeholder="Lat Ù‚Ø¨Ù„">
<input placeholder="Lat Ø¨Ø¹Ø¯">
<input placeholder="Lng Ù‚Ø¨Ù„">
<input placeholder="Lng Ø¨Ø¹Ø¯">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

function addCorner(){
corners.innerHTML+=`<div><b>Ø²Ø§ÙˆÙŠØ© ${corners.children.length+1}</b>${coordRow()}</div>`;
}
function addWell(){wells.innerHTML+=coordRow();}
function addIrrigation(){
irrigation.innerHTML+=`
<div class="row">
<input placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø±ÙŠ">
<input placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø·">
<input placeholder="Ø§Ù„Ù…Ø­ØµÙˆÙ„">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}
function addCrop(){
crops.innerHTML+=`
<div class="row">
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±ÙˆØ¹">
<input placeholder="Ø§Ù„Ù…Ø³Ø§Ø­Ø©">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}
function addAsset(){
assets.innerHTML+=`
<div class="row">
<input placeholder="Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯">
<input placeholder="Ø§Ù„ÙˆØµÙ">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}

/* Ù…Ø³Ø§ÙØ© Ø¯Ù‚ÙŠÙ‚Ø© */
function distance(lat1,lng1,lat2,lng2){
const R=6371000;
let dLat=(lat2-lat1)*Math.PI/180;
let dLng=(lng2-lng1)*Math.PI/180;
let a=Math.sin(dLat/2)**2+
Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*
Math.sin(dLng/2)**2;
return R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
}

/* ÙØ­Øµ Ø§Ù„Ø²ÙˆØ§ÙŠØ§ */
function checkCorners(){
let rows=document.querySelectorAll("#corners .row");
rows.forEach(r=>r.classList.remove("bad-corner","good-corner"));
let pts=[];
rows.forEach(r=>{
let i=r.querySelectorAll("input");
let lat=parseFloat(i[0].value+"."+i[1].value);
let lng=parseFloat(i[2].value+"."+i[3].value);
if(!isNaN(lat)&&!isNaN(lng)) pts.push({lat,lng,row:r});
else r.classList.add("bad-corner");
});
pts.forEach((p,i)=>{
let prev=pts[(i-1+pts.length)%pts.length];
let next=pts[(i+1)%pts.length];
let d1=distance(prev.lat,prev.lng,p.lat,p.lng);
let d2=distance(p.lat,p.lng,next.lat,next.lng);
if(d1<5||d2<5) p.row.classList.add("bad-corner");
else p.row.classList.add("good-corner");
});
}

/* Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø© */
function calcArea(){
let pts=[];
document.querySelectorAll("#corners .row").forEach(r=>{
let i=r.querySelectorAll("input");
let lat=parseFloat(i[0].value+"."+i[1].value);
let lng=parseFloat(i[2].value+"."+i[3].value);
if(!isNaN(lat)&&!isNaN(lng)) pts.push([lat,lng]);
});
if(pts.length<3){
areaResult.innerHTML="Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„";
return;
}

let txt="";
for(let i=0;i<pts.length;i++){
let j=(i+1)%pts.length;
let d=Math.round(distance(
pts[i][0],pts[i][1],pts[j][0],pts[j][1]
));
txt+=`Ø§Ù„Ù…Ø³Ø§ÙØ© Ø¨ÙŠÙ† Ø²Ø§ÙˆÙŠØ© ${i+1} Ùˆ ${j+1}: ${d} Ù…<br>`;
}

let area=0;
for(let i=0;i<pts.length;i++){
let j=(i+1)%pts.length;
area+=pts[i][0]*pts[j][1]-pts[j][0]*pts[i][1];
}
area=Math.abs(area/2)*111000*111000;

areaResult.innerHTML=
txt+`<hr>
Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${area.toFixed(1)} Ù…Â²<br>
Ø§Ù„Ù‡ÙƒØªØ§Ø±: ${(area/10000).toFixed(3)}<br>
Ø§Ù„Ø¯ÙˆÙ†Ù…: ${(area/1000).toFixed(2)}`;
}
</script>

</body>
</html>