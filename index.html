<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>
<style>
body{
  font-family: Tahoma, Arial;
  background:#f2f5f3;
  margin:0;
  padding:20px;
}
.container{
  max-width:900px;
  margin:auto;
}
/* ===== Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ===== */
.header{
  text-align:center;
  margin-bottom:25px;
  border:2px solid #2e7d32;
  padding:15px;
  border-radius:6px;
  background:#fff;
}
.header h1{
  margin:0;
  font-size:20px;
  color:#2e7d32;
}
.header h2{
  margin:5px 0 0;
  font-size:15px;
  color:#2e7d32;
}
/* ===== Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚ ===== */
.section{
  background:#fff;
  border-radius:6px;
  margin-bottom:15px;
  border:2px solid #2e7d32;
}
.section-title{
  background:#e8f5e9;
  color:#2e7d32;
  padding:8px 12px;
  font-size:14px;
  font-weight:bold;
  border-bottom:2px solid #2e7d32;
}
.section-body{
  padding:12px;
}
/* ===== Ø§Ù„Ø­Ù‚ÙˆÙ„ ===== */
.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.field{
  flex:1;
  min-width:150px;
}
label{
  font-size:13px;
  display:block;
  margin-bottom:4px;
  color:#2e7d32;
}
input, select, textarea{
  width:100%;
  padding:6px;
  box-sizing:border-box;
  font-size:13px;
  border:1px solid #2e7d32;
  border-radius:4px;
}
button{
  padding:6px 10px;
  font-size:13px;
  cursor:pointer;
  background:#2e7d32;
  color:#fff;
  border:none;
  border-radius:4px;
}
button:hover{
  opacity:0.9;
}
/* ===== Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ===== */
@media print{
  body{
    background:#fff;
    padding:0;
  }
  button{
    display:none;
  }
}
</style>
</head>
<body>
<div class="container">
<!-- ===== Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ===== -->
<div class="header">
  <h1>ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</h1>
  <h2>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§</h2>
  <h2>ÙƒØ´Ù ÙÙ†ÙŠ</h2>
</div>
<!-- Ø§Ù„Ø¨Ù†ÙˆØ¯ ØªØ¶Ø§Ù Ù‡Ù†Ø§ -->
</div>
</body>
</html><!-- ===== Ø¨Ù†Ø¯ 1 : Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© ===== -->
<div class="section">
  <div class="section-title">1ï¸âƒ£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</div>
  <div class="section-body">
    <div class="row">
      <div class="field">
        <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
        <input type="text" id="clientName">
      </div>
      <div class="field">
        <label>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label>
        <input type="text" id="orderNumber">
      </div>
      <div class="field">
        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
        <input type="date" id="visitDate">
      </div>
    </div>
  </div>
</div>
<!-- ===== Ø¨Ù†Ø¯ 2 : Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„ ===== -->
<div class="section">
  <div class="section-title">2ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</div>
  <div class="section-body">
    <div class="row">
      <div class="field">
        <label>Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ (Latitude)</label>
        <input type="text" id="recordLat" placeholder="Ù…Ø«Ø§Ù„: 27.90670">
      </div>
      <div class="field">
        <label>Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ (Longitude)</label>
        <input type="text" id="recordLng" placeholder="Ù…Ø«Ø§Ù„: 47.65737">
      </div>
    </div>
    <br>
    <button type="button" onclick="openRecordMap()">ğŸ“ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ø¨Ø± Google Maps</button>
  </div>
</div>
<!-- ===== Ø¨Ù†Ø¯ 3 : Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© ===== -->
<div class="section">
  <div class="section-title">3ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</div>
  <div class="section-body">
    <div class="row">
      <div class="field">
        <label>Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ (Latitude)</label>
        <input type="text" id="gateLat" placeholder="Ù…Ø«Ø§Ù„: 27.90670">
      </div>
      <div class="field">
        <label>Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ (Longitude)</label>
        <input type="text" id="gateLng" placeholder="Ù…Ø«Ø§Ù„: 47.65737">
      </div>
    </div>
    <br>
    <button type="button" onclick="openGateMap()">ğŸ“ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ø¨Ø± Google Maps</button>
    <button type="button" onclick="getGateLocation()">ğŸ§­ Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ</button>
  </div>
</div>
<script>
/* ===== Ø¨Ù†Ø¯ 2 ===== */
function openRecordMap(){
  const lat = document.getElementById("recordLat").value.trim();
  const lng = document.getElementById("recordLng").value.trim();
  if(!lat || !lng){
    alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©");
    return;
  }
  window.open("https://www.google.com/maps?q=" + lat + "," + lng, "_blank");
}
/* ===== Ø¨Ù†Ø¯ 3 ===== */
function openGateMap(){
  const lat = document.getElementById("gateLat").value.trim();
  const lng = document.getElementById("gateLng").value.trim();
  if(!lat || !lng){
    alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©");
    return;
  }
  window.open("https://www.google.com/maps?q=" + lat + "," + lng, "_blank");
}
function getGateLocation(){
  if(!navigator.geolocation){
    alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹");
    return;
  }
  navigator.geolocation.getCurrentPosition(
    pos => {
      document.getElementById("gateLat").value = pos.coords.latitude.toFixed(6);
      document.getElementById("gateLng").value = pos.coords.longitude.toFixed(6);
    },
    () => {
      alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹");
    }
  );
}
</script><!-- Ø¨Ù†Ø¯ 4 : Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø£Ø±Ø¶ ÙˆØ­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø·ÙˆØ§Ù„ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø© -->
<h3 style="color:green;">4- Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø£Ø±Ø¶ ÙˆØ­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø©</h3>

<style>
  .point{
    display:flex;
    gap:6px;
    margin-bottom:6px;
    align-items:center;
  }
  .point input{
    width:160px;
  }
</style>

<div id="points-container"></div>

<button onclick="addPoint()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button onclick="calculate()">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø·ÙˆØ§Ù„ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©</button>

<div id="result"></div>

<script>
// ==================
// WGS84 â†’ UTM (Zone ØªÙ„Ù‚Ø§Ø¦ÙŠ)
// ==================
const a = 6378137.0;
const f = 1 / 298.257223563;
const k0 = 0.9996;
const e = Math.sqrt(f * (2 - f));

function latLonToUTM(lat, lon) {
  const zone = Math.floor((lon + 180) / 6) + 1;
  const Î»0 = ((zone - 1) * 6 - 180 + 3) * Math.PI / 180;

  const Ï† = lat * Math.PI / 180;
  const Î» = lon * Math.PI / 180;

  const N = a / Math.sqrt(1 - e * e * Math.sin(Ï†) ** 2);
  const T = Math.tan(Ï†) ** 2;
  const C = (e * e / (1 - e * e)) * Math.cos(Ï†) ** 2;
  const A = Math.cos(Ï†) * (Î» - Î»0);

  const M =
    a * (
      (1 - e * e / 4 - 3 * e ** 4 / 64 - 5 * e ** 6 / 256) * Ï†
      - (3 * e ** 2 / 8 + 3 * e ** 4 / 32 + 45 * e ** 6 / 1024) * Math.sin(2 * Ï†)
      + (15 * e ** 4 / 256 + 45 * e ** 6 / 1024) * Math.sin(4 * Ï†)
      - (35 * e ** 6 / 3072) * Math.sin(6 * Ï†)
    );

  const x =
    k0 * N * (
      A +
      (1 - T + C) * A ** 3 / 6 +
      (5 - 18 * T + T ** 2 + 72 * C - 58 * e ** 2) * A ** 5 / 120
    ) + 500000;

  let y =
    k0 * (
      M +
      N * Math.tan(Ï†) * (
        A ** 2 / 2 +
        (5 - T + 9 * C + 4 * C ** 2) * A ** 4 / 24 +
        (61 - 58 * T + T ** 2 + 600 * C - 330 * e ** 2) * A ** 6 / 720
      )
    );

  if (lat < 0) y += 10000000;

  return { x, y, zone };
}

// ==================
// Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ§Øª ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©
// ==================
function distance(p1, p2) {
  return Math.hypot(p2.x - p1.x, p2.y - p1.y);
}

function polygonArea(points) {
  let area = 0;
  for (let i = 0; i < points.length; i++) {
    let j = (i + 1) % points.length;
    area += points[i].x * points[j].y;
    area -= points[j].x * points[i].y;
  }
  return Math.abs(area / 2);
}

// ==================
// UI Logic
// ==================
function addPoint() {
  document.getElementById('points-container')
    .insertAdjacentHTML('beforeend', `
      <div class="point">
        <input type="number" step="any" class="lat" placeholder="Latitude">
        <input type="number" step="any" class="lon" placeholder="Longitude">
        <button onclick="removePoint(this)">âˆ’</button>
      </div>
    `);
}

function removePoint(btn) {
  btn.parentElement.remove();
}

function calculate() {
  const lats = document.querySelectorAll('.lat');
  const lons = document.querySelectorAll('.lon');

  if (lats.length < 3) {
    alert('Ù„Ø§ Ø¨Ø¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„');
    return;
  }

  let pts = [];
  let zoneUsed = null;

  for (let i = 0; i < lats.length; i++) {
    if (!lats[i].value || !lons[i].value) {
      alert('ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª');
      return;
    }
    const p = latLonToUTM(
      parseFloat(lats[i].value),
      parseFloat(lons[i].value)
    );
    zoneUsed = p.zone;
    pts.push(p);
  }

  let out = `<h4>Ø£Ø·ÙˆØ§Ù„ Ø§Ù„Ø£Ø¶Ù„Ø§Ø¹ (UTM Zone ${zoneUsed}):</h4>`;
  for (let i = 0; i < pts.length; i++) {
    let j = (i + 1) % pts.length;
    out += `Ø§Ù„Ø¶Ù„Ø¹ ${i+1}-${j+1}: ${distance(pts[i], pts[j]).toFixed(2)} Ù…<br>`;
  }

  const area = polygonArea(pts);
  out += `<h4>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</h4>
          ${area.toFixed(2)} Ù…Â²<br>
          ${(area / 10000).toFixed(2)} Ù‡ÙƒØªØ§Ø±<br>
          ${(area / 1000).toFixed(2)} Ø¯ÙˆÙ†Ù…`;

  document.getElementById('result').innerHTML = out;
}
</script><!-- Ø¨Ù†Ø¯ 5 : Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¢Ø¨Ø§Ø± -->
<h3 style="color:green;">5- Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells-container"></div>
<button onclick="addWell()">â• Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
<script>
let wells = [];
function saveWells() {
  localStorage.setItem("wells", JSON.stringify(wells));
}
function loadWells() {
  const data = localStorage.getItem("wells");
  if (data) {
    wells = JSON.parse(data);
    renderWells();
  }
}
function renderWells() {
  const c = document.getElementById("wells-container");
  c.innerHTML = "";
  wells.forEach((w, i) => {
    c.insertAdjacentHTML("beforeend", `
      <div class="well" style="border:1px solid #ccc;padding:10px;margin:10px 0;">
        <label>Latitude</label>
        <input type="number" step="any" value="${w.lat || ""}" 
               onchange="updateWell(${i}, 'lat', this.value)">
        <label>Longitude</label>
        <input type="number" step="any" value="${w.lon || ""}" 
               onchange="updateWell(${i}, 'lon', this.value)">
        <br><br>
        <button onclick="locateWell(${i})">ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
        <button onclick="openMap(${i})">ğŸ—ºï¸ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙˆÙ‚Ø¹</button>
        <button onclick="removeWell(${i})">â– Ø­Ø°Ù</button>
      </div>
    `);
  });
}
function addWell() {
  wells.push({ lat: "", lon: "" });
  saveWells();
  renderWells();
}
function removeWell(i) {
  wells.splice(i, 1);
  saveWells();
  renderWells();
}
function updateWell(i, key, value) {
  wells[i][key] = value;
  saveWells();
}
function locateWell(i) {
  if (!navigator.geolocation) {
    alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹");
    return;
  }
  navigator.geolocation.getCurrentPosition(
    (pos) => {
      wells[i].lat = pos.coords.latitude.toFixed(6);
      wells[i].lon = pos.coords.longitude.toFixed(6);
      saveWells();
      renderWells();
    },
    () => {
      alert("ØªØ¹Ø°Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŒ ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ GPS");
    },
    {
      enableHighAccuracy: true,
      timeout: 15000,
      maximumAge: 0
    }
  );
}
function openMap(i) {
  if (!wells[i].lat || !wells[i].lon) {
    alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹");
    return;
  }
  window.open(
    `https://www.google.com/maps?q=${wells[i].lat},${wells[i].lon}`,
    "_blank"
  );
}
loadWells();
</script><!-- Ø¨Ù†Ø¯ 6 : Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ -->
<h3 style="color:green;">6- Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigationContainer">
  <div class="irrigationBox" style="border:1px solid #ccc; padding:10px; margin-bottom:15px;">
    <h4>Ù†Ø¸Ø§Ù… Ø±ÙŠ Ø±Ù‚Ù… 1</h4>
    <label>Ù†ÙˆØ¹ Ø§Ù„Ø±ÙŠ</label>
    <select class="irrigationType" onchange="handleIrrigation(this)">
      <option value="">Ø§Ø®ØªØ±</option>
      <option value="sprinkler">Ø±Ø´Ø§Ø´</option>
      <option value="drip">ØªÙ†Ù‚ÙŠØ·</option>
      <option value="flood">ØºÙ…Ø±</option>
    </select>
    <!-- Ø±Ø´Ø§Ø´ -->
    <div class="sprinklerBox" style="display:none; margin-top:10px;">
      <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬</label>
      <input type="number" class="towerCount" oninput="calcSprinkler(this)">
      <label>Ø·ÙˆÙ„ Ø§Ù„Ø¨Ø±Ø¬ (Ù…)</label>
      <input type="number" class="towerLength" oninput="calcSprinkler(this)">
      <div class="sprinklerResult"></div>
    </div>
    <!-- ØªÙ†Ù‚ÙŠØ· -->
    <div class="dripBox" style="display:none; margin-top:10px;">
      <label>Ø§Ù„Ø·ÙˆÙ„ (Ù…)</label>
      <input type="number" class="dripLength" oninput="calcDrip(this)">
      <label>Ø§Ù„Ø¹Ø±Ø¶ (Ù…)</label>
      <input type="number" class="dripWidth" oninput="calcDrip(this)">
      <div class="dripResult"></div>
    </div>
    <!-- ØºÙ…Ø± -->
    <div class="floodBox" style="display:none; margin-top:10px;">
      <label>Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Ù…Â²)</label>
      <input type="number" class="floodArea" oninput="calcFlood(this)">
      <div class="floodResult"></div>
    </div>
    <hr>
    <!-- Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹ (Ø®Ø§Øµ Ø¨Ø§Ù„Ø±ÙŠ) -->
    <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹</label>
    <select class="irrigationCrop" onchange="handleIrrigationCrop(this)">
      <option value="">Ø§Ø®ØªØ±</option>
      <option value="wheat">Ù‚Ù…Ø­</option>
      <option value="fodder">Ø£Ø¹Ù„Ø§Ù Ø®Ø¶Ø±Ù‡</option>
      <option value="vegetables">Ø®Ø¶Ø§Ø±</option>
      <option value="other">Ø¢Ø®Ø±</option>
    </select>
    <div class="irrigationCropNote" style="display:none; margin-top:8px;">
      <label>ÙˆØµÙ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹</label>
      <input type="text">
    </div>
    <button onclick="removeIrrigation(this)">â– Ø­Ø°Ù</button>
  </div>
</div>
<button onclick="addIrrigation()">â• Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>
<script>
let irrigationIndex = 1;
function handleIrrigation(el) {
  const box = el.closest('.irrigationBox');
  box.querySelector('.sprinklerBox').style.display = 'none';
  box.querySelector('.dripBox').style.display = 'none';
  box.querySelector('.floodBox').style.display = 'none';
  if (el.value === 'sprinkler') box.querySelector('.sprinklerBox').style.display = 'block';
  if (el.value === 'drip') box.querySelector('.dripBox').style.display = 'block';
  if (el.value === 'flood') box.querySelector('.floodBox').style.display = 'block';
}
/* Ø±Ø´Ø§Ø´ â€“ Ø­Ø³Ø§Ø¨ Ø¯Ø§Ø¦Ø±ÙŠ Ø¯Ù‚ÙŠÙ‚ */
function calcSprinkler(el) {
  const box = el.closest('.irrigationBox');
  const count = +box.querySelector('.towerCount').value;
  const length = +box.querySelector('.towerLength').value;
  if (!count || !length) return;
  const radius = count * length;
  const area = Math.PI * radius * radius;
  showResult(area, box.querySelector('.sprinklerResult'));
}
/* ØªÙ†Ù‚ÙŠØ· */
function calcDrip(el) {
  const box = el.closest('.irrigationBox');
  const l = +box.querySelector('.dripLength').value;
  const w = +box.querySelector('.dripWidth').value;
  if (!l || !w) return;
  showResult(l * w, box.querySelector('.dripResult'));
}
/* ØºÙ…Ø± */
function calcFlood(el) {
  const area = +el.value;
  if (!area) return;
  const box = el.closest('.irrigationBox');
  showResult(area, box.querySelector('.floodResult'));
}
/* Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ */
function showResult(area, target) {
  target.innerHTML = `
    <p><strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</strong></p>
    <p>${area.toLocaleString(undefined,{maximumFractionDigits:2})} Ù…Â²</p>
    <p>${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø±</p>
    <p>${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…</p>
  `;
}
/* Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹ */
function handleIrrigationCrop(el) {
  const box = el.closest('.irrigationBox');
  const note = box.querySelector('.irrigationCropNote');
  note.style.display =
    (el.value === 'fodder' || el.value === 'vegetables' || el.value === 'other')
      ? 'block'
      : 'none';
}
/* Ø¥Ø¶Ø§ÙØ© / Ø­Ø°Ù */
function addIrrigation() {
  irrigationIndex++;
  irrigationContainer.insertAdjacentHTML('beforeend',
    irrigationContainer.children[0].outerHTML.replace(/Ø±Ù‚Ù… 1/g, 'Ø±Ù‚Ù… ' + irrigationIndex)
  );
}
function removeIrrigation(btn) {
  btn.closest('.irrigationBox').remove();
}
</script><!-- Ø¨Ù†Ø¯ 7 : Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª -->
<h3 style="color:green;">7- Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="plantsContainer">
  <div class="plantBox" style="margin-bottom:15px; border:1px solid #ccc; padding:10px;">
    <h4>Ù…Ø²Ø±ÙˆØ¹Ø§Øª Ø±Ù‚Ù… 1</h4>
    <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹</label>
    <select class="plantType" onchange="handlePlantType(this)">
      <option value="">Ø§Ø®ØªØ±</option>
      <option value="palm">Ù†Ø®ÙŠÙ„</option>
      <option value="wind">Ù…ØµØ¯Ø§Øª Ø±ÙŠØ§Ø­</option>
      <option value="citrus">Ø­Ù…Ø¶ÙŠØ§Øª</option>
      <option value="other">Ø¢Ø®Ø±</option>
    </select>
    <div class="plantNote" style="display:none; margin-top:8px;">
      <label>ÙˆØµÙ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹</label>
      <input type="text">
    </div>
    <label>Ù…Ø³Ø§ÙØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø©</label>
    <select class="plantSpacing" onchange="calcPlant(this)">
      <option value="">Ø§Ø®ØªØ±</option>
      <option value="49">7 Ã— 7 Ù…ØªØ±</option>
      <option value="64">8 Ã— 8 Ù…ØªØ±</option>
      <option value="100">10 Ã— 10 Ù…ØªØ±</option>
    </select>
    <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø´ØªÙ„Ø§Øª</label>
    <input type="number" class="plantCount" oninput="calcPlant(this)">
    <div class="plantResult" style="margin-top:10px;"></div>
    <button onclick="removePlant(this)">â– Ø­Ø°Ù</button>
  </div>
</div>
<button onclick="addPlant()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹Ø§Øª</button>
<script>
let plantIndex = 1;
function handlePlantType(el) {
  const box = el.closest('.plantBox');
  const note = box.querySelector('.plantNote');
  const v = el.value;
  note.style.display = (v === 'citrus' || v === 'other') ? 'block' : 'none';
}
function calcPlant(el) {
  const box = el.closest('.plantBox');
  const count = +box.querySelector('.plantCount').value;
  const spacing = +box.querySelector('.plantSpacing').value;
  if (!count || !spacing) return;
  const area = count * spacing;
  const donum = area / 1000;
  const hectare = area / 10000;
  box.querySelector('.plantResult').innerHTML = `
    <p><strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©:</strong></p>
    <p>${area.toLocaleString()} Ù…Â²</p>
    <p>${donum.toFixed(2)} Ø¯ÙˆÙ†Ù…</p>
    <p>${hectare.toFixed(2)} Ù‡ÙƒØªØ§Ø±</p>
  `;
}
function addPlant() {
  plantIndex++;
  plantsContainer.insertAdjacentHTML('beforeend', `
    <div class="plantBox" style="margin-bottom:15px; border:1px solid #ccc; padding:10px;">
      <h4>Ù…Ø²Ø±ÙˆØ¹Ø§Øª Ø±Ù‚Ù… ${plantIndex}</h4>
      <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹</label>
      <select class="plantType" onchange="handlePlantType(this)">
        <option value="">Ø§Ø®ØªØ±</option>
        <option value="palm">Ù†Ø®ÙŠÙ„</option>
        <option value="wind">Ù…ØµØ¯Ø§Øª Ø±ÙŠØ§Ø­</option>
        <option value="citrus">Ø­Ù…Ø¶ÙŠØ§Øª</option>
        <option value="other">Ø¢Ø®Ø±</option>
      </select>
      <div class="plantNote" style="display:none; margin-top:8px;">
        <label>ÙˆØµÙ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹</label>
        <input type="text">
      </div>
      <label>Ù…Ø³Ø§ÙØ© Ø§Ù„Ø²Ø±Ø§Ø¹Ø©</label>
      <select class="plantSpacing" onchange="calcPlant(this)">
        <option value="">Ø§Ø®ØªØ±</option>
        <option value="49">7 Ã— 7 Ù…ØªØ±</option>
        <option value="64">8 Ã— 8 Ù…ØªØ±</option>
        <option value="100">10 Ã— 10 Ù…ØªØ±</option>
      </select>
      <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø´ØªÙ„Ø§Øª</label>
      <input type="number" class="plantCount" oninput="calcPlant(this)">
      <div class="plantResult" style="margin-top:10px;"></div>
      <button onclick="removePlant(this)">â– Ø­Ø°Ù</button>
    </div>
  `);
}
function removePlant(btn) {
  btn.parentElement.remove();
}
</script><!-- Ø¨Ù†Ø¯ 8 : Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª -->
<h3 style="color:green;">8- Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<!-- ================= Ù…Ø¨Ø§Ù†ÙŠ ================= -->
<h4>1- Ù…Ø¨Ø§Ù†ÙŠ</h4>
<div id="buildingsContainer"></div>
<button type="button" onclick="addBuilding()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø¨Ù†Ù‰</button>
<hr>
<!-- ================= Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø¦Ø± ================= -->
<h4>2- Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø¦Ø±</h4>
<div id="wellAssetsContainer"></div>
<button type="button" onclick="addWellAsset()">â• Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø¦Ø±</button>
<hr>
<!-- ================= Ø¢Ø®Ø± ================= -->
<h4>3- Ø£Ø®Ø±Ù‰</h4>
<div id="otherAssetsContainer"></div>
<button type="button" onclick="addOtherAsset()">â• Ø¥Ø¶Ø§ÙØ© Ø¢Ø®Ø±</button>
<script>
/* ===== Ø¹Ù†Ø§ØµØ± Ù…Ø´ØªØ±ÙƒØ© ===== */
function removeBox(btn) {
  btn.closest('.assetBox').remove();
}
function handleAsset(select) {
  const box = select.closest('.assetBox');
  const note = box.querySelector('.assetNote');
  note.style.display = select.value ? 'block' : 'none';
}
/* ===== Ù…Ø¨Ø§Ù†ÙŠ ===== */
function addBuilding() {
  document.getElementById('buildingsContainer').insertAdjacentHTML('beforeend', `
    <div class="assetBox" style="border:1px solid #ccc; padding:10px; margin-bottom:10px;">
      <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¨Ù†Ù‰</label>
      <select onchange="handleAsset(this)">
        <option value="">Ø§Ø®ØªØ±</option>
        <option>Ø³ÙƒÙ† Ø¹Ù…Ø§Ù„</option>
        <option>Ø§Ø³ØªØ±Ø§Ø­Ø©</option>
        <option>Ù…Ø³ØªÙˆØ¯Ø¹</option>
        <option>Ø®Ø²Ø§Ù† Ù…Ø§Ø¡</option>
      </select>
      <div class="assetNote" style="display:none; margin-top:8px;">
        <label>ÙˆØµÙ / Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
        <input type="text" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ø¯Ø¯ Ø§Ù„ØºØ±ÙØŒ Ø§Ù„Ø³Ø¹Ø©ØŒ Ø§Ù„Ø­Ø§Ù„Ø©">
      </div>
      <button type="button" onclick="removeBox(this)">â– Ø­Ø°Ù</button>
    </div>
  `);
}
/* ===== Ù…ÙˆØ¬ÙˆØ¯Ø§Øª Ø§Ù„Ø¨Ø¦Ø± ===== */
function addWellAsset() {
  document.getElementById('wellAssetsContainer').insertAdjacentHTML('beforeend', `
    <div class="assetBox" style="border:1px solid #ccc; padding:10px; margin-bottom:10px;">
      <label>Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯</label>
      <select onchange="handleAsset(this)">
        <option value="">Ø§Ø®ØªØ±</option>
        <option>Ø±Ø£Ø³ ÙƒÙ‡Ø±Ø¨</option>
        <option>ØºØ·Ø§Ø³</option>
        <option>Ù…ÙƒÙŠÙ†Ø© + Ø·Ø±Ù…Ø¨Ø©</option>
      </select>
      <div class="assetNote" style="display:none; margin-top:8px;">
        <label>ÙˆØµÙ / Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
        <input type="text" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù‚Ø¯Ø±Ø©ØŒ Ø§Ù„Ø¹Ù…Ù‚ØŒ Ø§Ù„Ø­Ø§Ù„Ø©">
      </div>
      <button type="button" onclick="removeBox(this)">â– Ø­Ø°Ù</button>
    </div>
  `);
}
/* ===== Ø£Ø®Ø±Ù‰ ===== */
function addOtherAsset() {
  document.getElementById('otherAssetsContainer').insertAdjacentHTML('beforeend', `
    <div class="assetBox" style="border:1px solid #ccc; padding:10px; margin-bottom:10px;">
      <label>ÙˆØµÙ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯</label>
      <input type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ØªÙØµÙŠÙ„">
      <button type="button" onclick="removeBox(this)">â– Ø­Ø°Ù</button>
    </div>
  `);
}
</script><!-- Ø¨Ù†Ø¯ 9 : Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø« -->
<div id="section9">
  <h3 style="color:green;">9- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
  <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</label>
  <input type="text" id="researcherName" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«">
  <hr>
  <div style="margin-top:10px;">
    <button onclick="saveForm()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
    <button onclick="clearForm()">ğŸ—‘ Ø­Ø°Ù Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
    <button onclick="printPDF()">ğŸ–¨ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
  </div>
</div>
<!-- ===== ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ===== -->
<style>
body{
  font-family: Arial, sans-serif;
  font-size: 12px;
  line-height: 1.4;
}
@media print {
  button{
    display:none;
  }
  input, select, textarea{
    border:none;
    font-size:12px;
  }
  h3{
    font-size:14px;
    margin-top:8px;
  }
  .page1{
    page-break-after:always;
  }
  @page{
    size:A4;
    margin:10mm;
  }
}
</style>
<!-- ===== Ø³ÙƒØ±Ø¨Øª Ø§Ù„ØªØ­ÙƒÙ… ===== -->
<script>
/* Ø­ÙØ¸ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
function saveForm(){
  localStorage.setItem('farmFormData', document.body.innerHTML);
  alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ù†Ø¬Ø§Ø­');
}
/* Ø­Ø°Ù Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
function clearForm(){
  if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ØŸ')){
    localStorage.removeItem('farmFormData');
    location.reload();
  }

}
/* Ø·Ø¨Ø§Ø¹Ø© PDF */
function printPDF(){
  window.print();
}
/* Ø§Ø³ØªØ±Ø¬Ø§Ø¹ ØªÙ„Ù‚Ø§Ø¦ÙŠ */
window.onload = function(){
  const saved = localStorage.getItem('farmFormData');
  if(saved){
    document.body.innerHTML = saved;
  }
};
</script>
