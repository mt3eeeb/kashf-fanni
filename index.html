<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ÙƒØ´Ù ÙÙ†ÙŠ Ø²Ø±Ø§Ø¹ÙŠ</title>

<style>
body{
    font-family: Tahoma, Arial;
    background:#f2f2f2;
    margin:0;
}
.container{
    max-width:900px;
    margin:auto;
    background:#fff;
    padding:12px;
}
.header{
    text-align:center;
    margin-bottom:15px;
}
.header h1{margin:5px 0;}
.section{
    margin-bottom:15px;
}
.section h3{
    background:#2ecc71;
    color:#fff;
    padding:8px;
    margin:0 0 8px;
    font-size:15px;
}
.row{
    display:flex;
    gap:5px;
    margin-bottom:5px;
    flex-wrap:wrap;
}
input{
    flex:1;
    padding:6px;
    font-size:13px;
}
button{
    padding:6px 8px;
    border:none;
    cursor:pointer;
    font-size:12px;
}
.add{background:#2ecc71;color:#fff;}
.del{background:#e74c3c;color:#fff;}
.map{background:#3498db;color:#fff;}
.gaia{background:#8e44ad;color:#fff;}
.gray{background:#ddd;}
.result{
    background:#eee;
    padding:8px;
    font-size:13px;
    margin-top:5px;
}
.center{text-align:center;}

@media print{
  button{display:none;}
  .page-break{page-break-before:always;}
  body{background:#fff;}
}
</style>
</head>

<body>
<div class="container">

<div class="header">
    <small>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§</small>
    <h1>ÙƒØ´Ù ÙÙ†ÙŠ</h1>
</div>

<!-- ================= Ø§Ù„ØµÙØ­Ø© 1 ================= -->

<div class="section">
<h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<input placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨">
<input type="date">
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
<input class="lat" placeholder="Latitude">
<input class="lng" placeholder="Longitude">
<button class="map" onclick="openMap(this)">Google</button>
<button class="gaia" onclick="openGaia(this)">Gaia</button>
</div>
</div>

<div class="section">
<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
<input class="lat" placeholder="Latitude">
<input class="lng" placeholder="Longitude">
<button class="gray" onclick="getLocation(this)">ğŸ“ ØªØ­Ø¯ÙŠØ¯</button>
<button class="map" onclick="openMap(this)">Google</button>
<button class="gaia" onclick="openGaia(this)">Gaia</button>
</div>
</div>

<div class="section">
<h3>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ø£Ø±Ø¶ (Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø©)</h3>
<div id="corners"></div>
<button class="add" onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button class="gray" onclick="calcArea()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø©</button>
<div id="areaResult" class="result"></div>
</div>

<div class="page-break"></div>

<!-- ================= Ø§Ù„ØµÙØ­Ø© 2 ================= -->

<div class="section">
<h3>Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells"></div>
<button class="add" onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
</div>

<div class="section">
<h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigation"></div>
<button class="add" onclick="addIrrigation()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>
<div id="irrigationResult" class="result"></div>
</div>

<div class="section">
<h3>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button class="add" onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>
</div>

<div class="section">
<h3>Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button class="add" onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>
</div>

<div class="section">
<h3>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«">
</div>

<div class="section center">
<button class="gray" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

</div>

<script>
/* ---------- Ø§Ù„Ø®Ø±Ø§Ø¦Ø· ---------- */
function openMap(btn){
    const row = btn.parentElement;
    const lat = row.querySelector(".lat").value;
    const lng = row.querySelector(".lng").value;
    if(!lat || !lng){alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª");return;}
    window.open(`https://www.google.com/maps?q=${lat},${lng}`);
}
function openGaia(btn){
    const row = btn.parentElement;
    const lat = row.querySelector(".lat").value;
    const lng = row.querySelector(".lng").value;
    if(!lat || !lng){alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª");return;}
    window.open(`https://www.gaiagps.com/map/?loc=${lat},${lng}`);
}
function getLocation(btn){
    if(!navigator.geolocation){alert("ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…");return;}
    navigator.geolocation.getCurrentPosition(pos=>{
        const row = btn.parentElement;
        row.querySelector(".lat").value = pos.coords.latitude.toFixed(6);
        row.querySelector(".lng").value = pos.coords.longitude.toFixed(6);
    });
}

/* ---------- Ø¥Ø¶Ø§ÙØ© ØµÙÙˆÙ ---------- */
function cornerRow(){
return `
<div class="row">
<input class="lat" placeholder="Latitude">
<input class="lng" placeholder="Longitude">
<button class="map" onclick="openMap(this)">G</button>
<button class="gaia" onclick="openGaia(this)">Gaia</button>
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;
}
function addCorner(){corners.innerHTML+=cornerRow();}
function addWell(){
wells.innerHTML+=`
<div class="row">
<input placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø¦Ø±">
<input class="lat" placeholder="Lat">
<input class="lng" placeholder="Lng">
<button class="gray" onclick="getLocation(this)">ğŸ“</button>
<button class="map" onclick="openMap(this)">G</button>
<button class="gaia" onclick="openGaia(this)">Gaia</button>
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;}
function addIrrigation(){
irrigation.innerHTML+=`
<div class="row">
<input placeholder="Ù†ÙˆØ¹ Ø§Ù„Ø±ÙŠ">
<input class="pivot" type="number" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆØ±">
<button class="del" onclick="this.parentElement.remove()">âˆ’</button>
</div>`;}
function addCrop(){crops.innerHTML+=`<div class="row"><input><input><button class="del" onclick="this.parentElement.remove()">âˆ’</button></div>`;}
function addAsset(){assets.innerHTML+=`<div class="row"><input><input><button class="del" onclick="this.parentElement.remove()">âˆ’</button></div>`;}

/* ---------- Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ù…Ù† Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª ---------- */
function calcArea(){
let pts=[];
document.querySelectorAll("#corners .row").forEach(r=>{
    let lat=parseFloat(r.querySelector(".lat").value);
    let lng=parseFloat(r.querySelector(".lng").value);
    if(!isNaN(lat)&&!isNaN(lng)) pts.push([lat,lng]);
});
if(pts.length<3){alert("Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");return;}

const R=6378137;
let area=0;
for(let i=0;i<pts.length;i++){
 let [lat1,lng1]=pts[i];
 let [lat2,lng2]=pts[(i+1)%pts.length];
 area+=((lng2-lng1)*Math.PI/180)*
 (2+Math.sin(lat1*Math.PI/180)+Math.sin(lat2*Math.PI/180));
}
area=Math.abs(area*R*R/2);

let ha=area/10000;
let dun=area/1000;

areaResult.innerHTML=`
Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø£Ø±Ø¶:<br>
${area.toFixed(2)} Ù…Â²<br>
${ha.toFixed(3)} Ù‡ÙƒØªØ§Ø±<br>
${dun.toFixed(2)} Ø¯Ù†Ù…`;
}
</script>

</body>
</html>