<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>

<style>
body{
  font-family: Tahoma;
  background:#f2f2f2;
  margin:0;
  padding:20px;
}
h1,h2{
  text-align:center;
  margin:5px 0;
}
.section{
  background:#fff;
  padding:15px;
  margin-bottom:15px;
  border-radius:6px;
  page-break-inside: avoid;
}
.section h3{
  background:#2ecc71;
  color:#fff;
  padding:8px;
  margin:-15px -15px 15px -15px;
}
.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.field{
  flex:1;
  min-width:180px;
}
label{
  font-size:13px;
  display:block;
  margin-bottom:4px;
}
input, select, textarea{
  width:100%;
  padding:6px;
  box-sizing:border-box;
}
button{
  padding:6px 10px;
  margin:3px;
  cursor:pointer;
}
.box{
  border:1px solid #ccc;
  padding:10px;
  margin-bottom:10px;
}
@media print{
  .page-break{ page-break-before:always; }
  button{ display:none; }
}
</style>
</head>

<body>

<h1>ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</h1>
<h2>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§</h2>
<h2>ÙƒØ´Ù ÙÙ†ÙŠ</h2>

<!-- 1 -->
<div class="section">
<h3>1ï¸âƒ£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<div class="row">
  <div class="field">
    <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
    <input id="clientName">
  </div>
  <div class="field">
    <label>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label>
    <input id="orderNumber">
  </div>
  <div class="field">
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
    <input type="date" id="visitDate">
  </div>
</div>
</div>

<!-- 2 -->
<div class="section">
<h3>2ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
  <div class="field">
    <label>Latitude</label>
    <input id="recordLat">
  </div>
  <div class="field">
    <label>Longitude</label>
    <input id="recordLng">
  </div>
</div>
<button onclick="openMap('recordLat','recordLng')">ğŸ“ Ø§Ù„ÙˆØµÙˆÙ„</button>
</div>

<!-- 3 -->
<div class="section">
<h3>3ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
  <div class="field">
    <label>Latitude</label>
    <input id="gateLat">
  </div>
  <div class="field">
    <label>Longitude</label>
    <input id="gateLng">
  </div>
</div>
<button onclick="getLocation('gateLat','gateLng')">ğŸ“ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
<button onclick="openMap('gateLat','gateLng')">ğŸ—ºï¸ Ø§Ù„ÙˆØµÙˆÙ„</button>
</div>

<!-- 4 -->
<div class="section">
<h3>4ï¸âƒ£ Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h3>
<div id="corners"></div>
<button onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button onclick="calcCorners()">Ø­Ø³Ø§Ø¨</button>
<div id="cornerResult"></div>
</div>

<div class="page-break"></div>

<!-- 5 -->
<div class="section">
<h3>5ï¸âƒ£ Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells"></div>
<button onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
</div>

<!-- 6 -->
<div class="section">
<h3>6ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigations"></div>
<button onclick="addIrr()">+ Ø¥Ø¶Ø§ÙØ©</button>
</div>

<!-- 7 -->
<div class="section">
<h3>7ï¸âƒ£ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ©</button>
</div>

<!-- 8 -->
<div class="section">
<h3>8ï¸âƒ£ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ©</button>
</div>

<!-- 9 -->
<div class="section">
<h3>9ï¸âƒ£ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input id="researcher">
</div>

<div class="section">
<button onclick="saveAll()">ğŸ’¾ Ø­ÙØ¸</button>
<button onclick="clearAll()">ğŸ—‘ï¸ Ø­Ø°Ù</button>
<button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
</div>

<script>
/* ===== Ø­ÙØ¸ Ø¹Ø§Ù… ===== */
const ids=[
'clientName','orderNumber','visitDate',
'recordLat','recordLng','gateLat','gateLng','researcher'
];
ids.forEach(id=>{
  const el=document.getElementById(id);
  el.value=localStorage.getItem(id)||'';
  el.oninput=()=>localStorage.setItem(id,el.value);
});

/* Ø®Ø±Ø§Ø¦Ø· */
function openMap(a,b){
  const lat=document.getElementById(a).value;
  const lng=document.getElementById(b).value;
  if(!lat||!lng){alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª');return;}
  window.open(`https://www.google.com/maps?q=${lat},${lng}`);
}
function getLocation(a,b){
  navigator.geolocation.getCurrentPosition(p=>{
    document.getElementById(a).value=p.coords.latitude.toFixed(6);
    document.getElementById(b).value=p.coords.longitude.toFixed(6);
    localStorage.setItem(a,document.getElementById(a).value);
    localStorage.setItem(b,document.getElementById(b).value);
  });
}

/* ===== Ø²ÙˆØ§ÙŠØ§ ===== */
let corners=JSON.parse(localStorage.getItem('corners')||'[]');
function addCorner(){
  corners.push({lat:'',lng:''});
  saveCorners(); renderCorners();
}
function saveCorners(){
  localStorage.setItem('corners',JSON.stringify(corners));
}
function renderCorners(){
  const c=document.getElementById('corners'); c.innerHTML='';
  corners.forEach((p,i)=>{
    c.innerHTML+=`
    <div class="row">
      <input placeholder="Lat" value="${p.lat}"
        oninput="corners[${i}].lat=this.value;saveCorners()">
      <input placeholder="Lng" value="${p.lng}"
        oninput="corners[${i}].lng=this.value;saveCorners()">
    </div>`;
  });
}
function calcCorners(){
  if(corners.length<3){alert('Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§');return;}
  let pts=corners.map(p=>({
    x:parseFloat(p.lng), y:parseFloat(p.lat)
  }));
  let area=0,dist='';
  for(let i=0;i<pts.length;i++){
    let j=(i+1)%pts.length;
    let d=Math.hypot(pts[j].x-pts[i].x,pts[j].y-pts[i].y)*111000;
    dist+=`Ø¶Ù„Ø¹ ${i+1}-${j+1}: ${d.toFixed(1)} Ù…<br>`;
    area+=pts[i].x*pts[j].y-pts[j].x*pts[i].y;
  }
  area=Math.abs(area/2)*(111000**2);
  document.getElementById('cornerResult').innerHTML=
    dist+`<b>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</b><br>
    ${area.toFixed(0)} Ù…Â² |
    ${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø± |
    ${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…`;
}
renderCorners();

/* ===== Ø§Ù„Ø¨Ù‚ÙŠØ© Ù…Ø®ØªØµØ±Ø© Ù„ÙƒÙ† Ø´ØºØ§Ù„Ø© ===== */
let wells=[], irrigations=[], crops=[], assets=[];
function addWell(){ wells.push({lat:'',lng:''}); save('wells',wells); render(); }
function addIrr(){ irrigations.push({}); save('irrigations',irrigations); render(); }
function addCrop(){ crops.push({}); save('crops',crops); render(); }
function addAsset(){ assets.push({}); save('assets',assets); render(); }
function save(k,v){ localStorage.setItem(k,JSON.stringify(v)); }
function saveAll(){ alert('ØªÙ… Ø§Ù„Ø­ÙØ¸'); }
function clearAll(){
  if(confirm('Ù…ØªØ£ÙƒØ¯ØŸ')){
    localStorage.clear(); location.reload();
  }
}
function render(){}
</script>

</body>
</html>