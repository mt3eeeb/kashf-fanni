<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø£Ø±Ø¶ â€“ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø© WGS84</title>

<style>
body {
  font-family: Tahoma, Arial;
  background: #fff;
  padding: 20px;
}

h2 {
  margin-bottom: 15px;
}

.row {
  display: flex;
  gap: 10px;
  margin-bottom: 8px;
}

input {
  width: 100%;
  padding: 8px;
  font-size: 15px;
}

button {
  padding: 10px 16px;
  font-size: 15px;
  cursor: pointer;
}

#results {
  margin-top: 20px;
  font-size: 22px;
}
</style>
</head>

<body>

<h2>4- Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø£Ø±Ø¶</h2>

<div id="points">
  <div class="row">
    <input type="number" step="any" placeholder="Latitude">
    <input type="number" step="any" placeholder="Longitude">
  </div>
  <div class="row">
    <input type="number" step="any" placeholder="Latitude">
    <input type="number" step="any" placeholder="Longitude">
  </div>
  <div class="row">
    <input type="number" step="any" placeholder="Latitude">
    <input type="number" step="any" placeholder="Longitude">
  </div>
  <div class="row">
    <input type="number" step="any" placeholder="Latitude">
    <input type="number" step="any" placeholder="Longitude">
  </div>
</div>

<button onclick="addPoint()">â• Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<button onclick="calcArea()">ğŸ“ Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø§Ø­Ø©</button>

<div id="results"></div>

<script>
const R = 6378137; // Ù†ØµÙ Ù‚Ø·Ø± Ø§Ù„Ø£Ø±Ø¶ WGS84 Ø¨Ø§Ù„Ù…ØªØ±

function addPoint() {
  const row = document.createElement("div");
  row.className = "row";
  row.innerHTML = `
    <input type="number" step="any" placeholder="Latitude">
    <input type="number" step="any" placeholder="Longitude">
  `;
  document.getElementById("points").appendChild(row);
}

function toRad(d) {
  return d * Math.PI / 180;
}

// Ø­Ø³Ø§Ø¨ Ù…Ø³Ø§Ø­Ø© Ù…Ø¶Ù„Ø¹ Ø¬ÙŠÙˆØ°ÙŠØ³ÙŠ (ØµØ­ Ù„Ù„Ø¬ÙˆØ§Ù„ ÙˆØ§Ù„Ù„Ø§Ø¨ØªÙˆØ¨)
function polygonArea(coords) {
  let area = 0;
  for (let i = 0; i < coords.length; i++) {
    const p1 = coords[i];
    const p2 = coords[(i + 1) % coords.length];

    const lat1 = toRad(p1.lat);
    const lat2 = toRad(p2.lat);
    const lon1 = toRad(p1.lon);
    const lon2 = toRad(p2.lon);

    area += (lon2 - lon1) * (2 + Math.sin(lat1) + Math.sin(lat2));
  }
  area = area * R * R / 2;
  return Math.abs(area);
}

function calcArea() {
  const rows = document.querySelectorAll("#points .row");
  let coords = [];

  rows.forEach(r => {
    const lat = parseFloat(r.children[0].value);
    const lon = parseFloat(r.children[1].value);
    if (!isNaN(lat) && !isNaN(lon)) {
      coords.push({ lat, lon });
    }
  });

  if (coords.length < 3) {
    alert("Ø£Ø¯Ø®Ù„ 3 Ù†Ù‚Ø§Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
    return;
  }

  const area_m2 = polygonArea(coords);
  const dunum = area_m2 / 1000;
  const hectare = area_m2 / 10000;

  document.getElementById("results").innerHTML = `
    <b>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</b><br><br>
    ${area_m2.toFixed(2)} Ù…Â²<br>
    ${dunum.toFixed(2)} Ø¯ÙˆÙ†Ù…<br>
    ${hectare.toFixed(2)} Ù‡ÙƒØªØ§Ø±
  `;
}
</script>

</body>
</html>
