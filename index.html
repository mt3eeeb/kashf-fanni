<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ÙƒØ´Ù ÙÙ†ÙŠ</title>

<style>
body{
  font-family:Tahoma;
  background:#f4f6f5;
  margin:0;
  padding:20px;
}
h1,h2{text-align:center;margin:0}
h1{font-size:20px}
h2{font-size:16px;color:#555;margin-bottom:20px}

.section{
  background:#fff;
  border-radius:6px;
  padding:15px;
  margin-bottom:15px;
}
.section h3{
  background:#2e7d32;
  color:#fff;
  padding:8px;
  margin:-15px -15px 15px -15px;
}
.row{display:flex;gap:10px;flex-wrap:wrap}
.field{flex:1;min-width:180px}
label{font-size:13px}
input,select,textarea,button{
  width:100%;
  padding:6px;
  margin-top:4px;
  box-sizing:border-box;
}
.item{
  border:1px solid #ccc;
  padding:10px;
  margin-bottom:8px;
}
button{cursor:pointer}
.no-print{margin-top:15px}
@media print{.no-print{display:none}}
</style>
</head>

<body>

<h1>ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ØªÙ†Ù…ÙŠØ© Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</h1>
<h2>Ù…ÙƒØªØ¨ Ù…Ø­Ø§ÙØ¸Ø© Ù‚Ø±ÙŠØ© Ø§Ù„Ø¹Ù„ÙŠØ§ â€“ ÙƒØ´Ù ÙÙ†ÙŠ</h2>

<!-- 1 -->
<div class="section">
<h3>1ï¸âƒ£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
<div class="row">
  <div class="field"><label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label><input id="client"></div>
  <div class="field"><label>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label><input id="order"></div>
  <div class="field"><label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label><input type="date" id="date"></div>
</div>
</div>

<!-- 2 -->
<div class="section">
<h3>2ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>
<div class="row">
  <div class="field"><label>Latitude</label><input id="recLat"></div>
  <div class="field"><label>Longitude</label><input id="recLng"></div>
</div>
<button onclick="openMap(recLat,recLng)">ğŸ“ Ø§Ù„ÙˆØµÙˆÙ„</button>
</div>

<!-- 3 -->
<div class="section">
<h3>3ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>
<div class="row">
  <div class="field"><label>Latitude</label><input id="gateLat"></div>
  <div class="field"><label>Longitude</label><input id="gateLng"></div>
</div>
<div class="row">
  <button onclick="openMap(gateLat,gateLng)">ğŸ“ Ø§Ù„ÙˆØµÙˆÙ„</button>
  <button onclick="getLocation(gateLat,gateLng)">ğŸ§­ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
</div>
</div>

<!-- 4 -->
<div class="section">
<h3>4ï¸âƒ£ Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h3>
<div id="corners"></div>
<button onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
<div id="cornerResult"></div>
</div>

<!-- 5 -->
<div class="section">
<h3>5ï¸âƒ£ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>
<div id="wells"></div>
<button onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>
</div>

<!-- 6 -->
<div class="section">
<h3>6ï¸âƒ£ Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>
<div id="irrigation"></div>
<button onclick="addIrr()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù…</button>
</div>

<!-- 7 -->
<div class="section">
<h3>7ï¸âƒ£ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>
<div id="crops"></div>
<button onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>
</div>

<!-- 8 -->
<div class="section">
<h3>8ï¸âƒ£ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>
<div id="assets"></div>
<button onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>
</div>

<!-- 9 -->
<div class="section">
<h3>9ï¸âƒ£ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«</h3>
<input id="researcher">
</div>

<div class="no-print">
<button onclick="saveAll()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
<button onclick="clearAll()">ğŸ—‘ï¸ ÙƒØ´Ù Ø¬Ø¯ÙŠØ¯</button>
<button onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

<script>
/* Ø£Ø¯ÙˆØ§Øª Ø¹Ø§Ù…Ø© */
function openMap(lat,lng){
 if(!lat.value||!lng.value){alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª");return;}
 window.open(`https://maps.google.com?q=${lat.value},${lng.value}`);
}
function getLocation(lat,lng){
 navigator.geolocation.getCurrentPosition(p=>{
  lat.value=p.coords.latitude.toFixed(6);
  lng.value=p.coords.longitude.toFixed(6);
  saveAll();
 });
}

/* Ø¨Ù†Ø¯ 4 Ø²ÙˆØ§ÙŠØ§ */
let corners=[];
function addCorner(){
 corners.push({lat:"",lng:""});
 renderCorners();
}
function renderCorners(){
 cornersDiv.innerHTML="";
 corners.forEach((c,i)=>{
  cornersDiv.innerHTML+=`
  <div class="item">
   <input placeholder="Lat" value="${c.lat}" oninput="corners[${i}].lat=this.value;calcCorners()">
   <input placeholder="Lng" value="${c.lng}" oninput="corners[${i}].lng=this.value;calcCorners()">
   <button onclick="corners.splice(${i},1);renderCorners()">âˆ’</button>
  </div>`;
 });
 calcCorners();
}
function calcCorners(){
 if(corners.length<3){cornerResult.innerHTML="";return;}
 let area=0;
 for(let i=0;i<corners.length;i++){
  let j=(i+1)%corners.length;
  area+=corners[i].lat*corners[j].lng-corners[j].lat*corners[i].lng;
 }
 area=Math.abs(area/2)*10000;
 cornerResult.innerHTML=
  `Ø§Ù„Ù…Ø³Ø§Ø­Ø©: ${area.toFixed(2)} Ù…Â² | ${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø± | ${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…`;
 saveAll();
}
const cornersDiv=document.getElementById("corners");
const cornerResult=document.getElementById("cornerResult");

/* Ø¨Ù†Ø¯ 5 Ø§Ù„Ø¢Ø¨Ø§Ø± */
let wells=[];
function addWell(){wells.push({lat:"",lng:""});renderWells();}
function renderWells(){
 wellsDiv.innerHTML="";
 wells.forEach((w,i)=>{
  wellsDiv.innerHTML+=`
  <div class="item">
   <input placeholder="Lat" value="${w.lat}" oninput="wells[${i}].lat=this.value;saveAll()">
   <input placeholder="Lng" value="${w.lng}" oninput="wells[${i}].lng=this.value;saveAll()">
   <button onclick="getLocation({value:''},{value:''})">ğŸ“</button>
   <button onclick="openMap({value:'${w.lat}'},{value:'${w.lng}'})">ğŸ—ºï¸</button>
   <button onclick="wells.splice(${i},1);renderWells()">âˆ’</button>
  </div>`;
 });
}
const wellsDiv=document.getElementById("wells");

/* Ø¨Ù†Ø¯ 6 Ø§Ù„Ø±ÙŠ */
let irrigation=[];
function addIrr(){
 irrigation.push({type:"",towers:0,len:0,crop:""});
 renderIrr();
}
function renderIrr(){
 irrigationDiv.innerHTML="";
 irrigation.forEach((r,i)=>{
  let total=r.towers*r.len;
  let area=total*50;
  irrigationDiv.innerHTML+=`
  <div class="item">
   Ù†ÙˆØ¹ Ø§Ù„Ø±ÙŠ <input value="${r.type}" oninput="irrigation[${i}].type=this.value;saveAll()">
   Ø·ÙˆÙ„ Ø§Ù„Ø¨Ø±Ø¬ <input type="number" value="${r.len}" oninput="irrigation[${i}].len=this.value;renderIrr()">
   Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬ <input type="number" value="${r.towers}" oninput="irrigation[${i}].towers=this.value;renderIrr()">
   Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹ <input value="${r.crop}" oninput="irrigation[${i}].crop=this.value;saveAll()">
   Ø§Ù„Ø·ÙˆÙ„ ${total} Ù… | Ø§Ù„Ù…Ø³Ø§Ø­Ø© ${area} Ù…Â² | ${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø± | ${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…
   <button onclick="irrigation.splice(${i},1);renderIrr()">âˆ’</button>
  </div>`;
 });
 saveAll();
}
const irrigationDiv=document.getElementById("irrigation");

/* Ø¨Ù†Ø¯ 7 Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª */
let crops=[];
function addCrop(){crops.push({type:"",count:0});renderCrops();}
function renderCrops(){
 cropsDiv.innerHTML="";
 crops.forEach((c,i)=>{
  let area=c.count*10;
  cropsDiv.innerHTML+=`
  <div class="item">
   Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹ <input value="${c.type}" oninput="crops[${i}].type=this.value;saveAll()">
   Ø¹Ø¯Ø¯ Ø§Ù„Ø´ØªÙ„Ø§Øª <input type="number" value="${c.count}" oninput="crops[${i}].count=this.value;renderCrops()">
   Ø§Ù„Ù…Ø³Ø§Ø­Ø© ${area} Ù…Â² | ${(area/10000).toFixed(2)} Ù‡ÙƒØªØ§Ø± | ${(area/1000).toFixed(2)} Ø¯ÙˆÙ†Ù…
   <button onclick="crops.splice(${i},1);renderCrops()">âˆ’</button>
  </div>`;
 });
 saveAll();
}
const cropsDiv=document.getElementById("crops");

/* Ø¨Ù†Ø¯ 8 Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª */
let assets=[];
function addAsset(){assets.push({name:"",count:0});renderAssets();}
function renderAssets(){
 assetsDiv.innerHTML="";
 assets.forEach((a,i)=>{
  assetsDiv.innerHTML+=`
  <div class="item">
   Ø§Ù„ÙˆØµÙ <input value="${a.name}" oninput="assets[${i}].name=this.value;saveAll()">
   Ø§Ù„Ø¹Ø¯Ø¯ <input type="number" value="${a.count}" oninput="assets[${i}].count=this.value;saveAll()">
   <button onclick="assets.splice(${i},1);renderAssets()">âˆ’</button>
  </div>`;
 });
}
const assetsDiv=document.getElementById("assets");

/* Ø­ÙØ¸ */
function saveAll(){
 localStorage.setItem("form",JSON.stringify({
  client:client.value,order:order.value,date:date.value,
  recLat:recLat.value,recLng:recLng.value,
  gateLat:gateLat.value,gateLng:gateLng.value,
  researcher:researcher.value,
  corners,wells,irrigation,crops,assets
 }));
}
(function(){
 let d=JSON.parse(localStorage.getItem("form")||"{}");
 Object.assign(window,d);
 client.value=d.client||"";order.value=d.order||"";date.value=d.date||"";
 recLat.value=d.recLat||"";recLng.value=d.recLng||"";
 gateLat.value=d.gateLat||"";gateLng.value=d.gateLng||"";
 researcher.value=d.researcher||"";
 corners=d.corners||[];wells=d.wells||[];
 irrigation=d.irrigation||[];crops=d.crops||[];assets=d.assets||[];
 renderCorners();renderWells();renderIrr();renderCrops();renderAssets();
})();
function clearAll(){
 if(confirm("ÙØªØ­ ÙƒØ´Ù Ø¬Ø¯ÙŠØ¯ØŸ")){localStorage.clear();location.reload();}
}
</script>

</body>
</html>