<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø¨Ù†Ø¯ 1 - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</title>

<style>
body{
  font-family: Tahoma;
  background:#f4f4f4;
  margin:0;
  padding:20px;
}
.section{
  background:#fff;
  padding:15px;
  border-radius:6px;
}
.section h3{
  background:#2ecc71;
  color:#fff;
  padding:8px;
  margin:-15px -15px 15px -15px;
}
.row{
  display:flex;
  gap:10px;
}
.field{
  flex:1;
}
label{
  font-size:13px;
  display:block;
  margin-bottom:3px;
}
input{
  width:100%;
  padding:7px;
  box-sizing:border-box;
}
</style>
</head>

<body>

<div class="section">
  <h3>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>

  <div class="row">
    <div class="field">
      <label>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
      <input type="text" id="clientName">
    </div>

    <div class="field">
      <label>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label>
      <input type="text" id="orderNumber">
    </div>

    <div class="field">
      <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
      <input type="date" id="visitDate">
    </div>
  </div>
</div>

</body>
</html>

<!-- Ø¨Ù†Ø¯ 2: Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„ -->
<div class="section">
  <h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„</h3>

  <div class="row">
    <div class="field">
      <label>Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ (Latitude)</label>
      <input type="text" id="recordLat" placeholder="Ù…Ø«Ø§Ù„: 27.90670">
    </div>

    <div class="field">
      <label>Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ (Longitude)</label>
      <input type="text" id="recordLng" placeholder="Ù…Ø«Ø§Ù„: 47.65737">
    </div>
  </div>

  <div style="margin-top:10px;">
    <button type="button" onclick="openRecordMap()">ğŸ“ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ø¨Ø± Google Maps</button>
  </div>
</div>

<script>
function openRecordMap(){
  const lat = document.getElementById('recordLat').value.trim();
  const lng = document.getElementById('recordLng').value.trim();

  if(lat === '' || lng === ''){
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©');
    return;
  }

  window.open(`https://www.google.com/maps?q=${lat},${lng}`);
}
</script>

<!-- Ø¨Ù†Ø¯ 3: Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© -->
<div class="section">
  <h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ© Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©</h3>

  <div class="row">
    <div class="field">
      <label>Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶ (Latitude)</label>
      <input type="text" id="gateLat" placeholder="Ù…Ø«Ø§Ù„: 27.90670">
    </div>

    <div class="field">
      <label>Ø®Ø· Ø§Ù„Ø·ÙˆÙ„ (Longitude)</label>
      <input type="text" id="gateLng" placeholder="Ù…Ø«Ø§Ù„: 47.65737">
    </div>
  </div>

  <div style="margin-top:10px; display:flex; gap:10px;">
    <button type="button" onclick="openGateMap()">ğŸ“ Ø§Ù„ÙˆØµÙˆÙ„ Ø¹Ø¨Ø± Google Maps</button>
    <button type="button" onclick="getGateLocation()">ğŸ§­ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
  </div>
</div>

<script>
function openGateMap(){
  const lat = document.getElementById('gateLat').value.trim();
  const lng = document.getElementById('gateLng').value.trim();

  if(lat === '' || lng === ''){
    alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©');
    return;
  }

  window.open(`https://www.google.com/maps?q=${lat},${lng}`);
}

function getGateLocation(){
  if(!navigator.geolocation){
    alert('Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹');
    return;
  }

  navigator.geolocation.getCurrentPosition(
    (position) => {
      document.getElementById('gateLat').value = position.coords.latitude.toFixed(6);
      document.getElementById('gateLng').value = position.coords.longitude.toFixed(6);
    },
    () => {
      alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹');
    }
  );
}
</script>

<section id="farm-corners">
  <h3>Ø²ÙˆØ§ÙŠØ§ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©</h3>

  <div id="corners"></div>

  <button type="button" onclick="addCorner()">+ Ø¥Ø¶Ø§ÙØ© Ø²Ø§ÙˆÙŠØ©</button>
  <button type="button" onclick="calculatePolygon()">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø·ÙˆØ§Ù„ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©</button>

  <div id="results" style="margin-top:15px"></div>
</section>

<script>
// ===============================
// Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­ÙˆÙŠÙ„ WGS84 â†’ UTM
// ===============================
function latLonToUTM(lat, lon) {
  const a = 6378137.0;
  const f = 1 / 298.257223563;
  const k0 = 0.9996;
  const e = Math.sqrt(f * (2 - f));

  const zone = 38; // Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©
  const Î»0 = ((zone - 1) * 6 - 180 + 3) * Math.PI / 180;

  const Ï† = lat * Math.PI / 180;
  const Î» = lon * Math.PI / 180;

  const N = a / Math.sqrt(1 - e * e * Math.sin(Ï†) ** 2);
  const T = Math.tan(Ï†) ** 2;
  const C = (e * e / (1 - e * e)) * Math.cos(Ï†) ** 2;
  const A = Math.cos(Ï†) * (Î» - Î»0);

  const M = a * (
    (1 - e*e/4 - 3*e**4/64 - 5*e**6/256) * Ï†
    - (3*e*e/8 + 3*e**4/32 + 45*e**6/1024) * Math.sin(2*Ï†)
    + (15*e**4/256 + 45*e**6/1024) * Math.sin(4*Ï†)
  );

  const easting = k0 * N * (
    A + (1 - T + C) * A**3 / 6
  ) + 500000;

  const northing = k0 * (M + N * Math.tan(Ï†) * A**2 / 2);

  return { x: easting, y: northing };
}

// ===============================
// Ø¥Ø¶Ø§ÙØ© / Ø­Ø°Ù Ø²ÙˆØ§ÙŠØ§
// ===============================
function addCorner(lat = "", lon = "") {
  const div = document.createElement("div");
  div.className = "corner";
  div.innerHTML = `
    Latitude <input type="number" step="any" value="${lat}">
    Longitude <input type="number" step="any" value="${lon}">
    <button type="button" onclick="this.parentNode.remove()">âˆ’</button>
  `;
  document.getElementById("corners").appendChild(div);
}

// Ø²ÙˆØ§ÙŠØ§ Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (ØªÙ‚Ø¯Ø± ØªØ­Ø°ÙÙ‡Ø§)
addCorner(27.90670, 47.65737);
addCorner(27.89539, 47.63094);
addCorner(27.87591, 47.64401);
addCorner(27.88323, 47.67417);

// ===============================
// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø·ÙˆØ§Ù„ ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©
// ===============================
function calculatePolygon() {
  const rows = document.querySelectorAll(".corner");
  let points = [];

  rows.forEach(r => {
    const lat = parseFloat(r.children[0].value);
    const lon = parseFloat(r.children[1].value);
    if (!isNaN(lat) && !isNaN(lon)) {
      points.push(latLonToUTM(lat, lon));
    }
  });

  if (points.length < 3) {
    alert("Ø£Ø¯Ø®Ù„ 3 Ø²ÙˆØ§ÙŠØ§ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
    return;
  }

  let distances = "";
  let area = 0;

  for (let i = 0; i < points.length; i++) {
    const p1 = points[i];
    const p2 = points[(i + 1) % points.length];

    const d = Math.hypot(p2.x - p1.x, p2.y - p1.y);
    distances += `Ø§Ù„Ù…Ø³Ø§ÙØ© ${i+1} â†’ ${i+2}: ${d.toFixed(2)} Ù…<br>`;

    area += (p1.x * p2.y - p2.x * p1.y);
  }

  area = Math.abs(area / 2);

  const hectares = area / 10000;
  const dunum = area / 1000;

  document.getElementById("results").innerHTML = `
    <hr>
    <strong>Ø§Ù„Ø£Ø·ÙˆØ§Ù„:</strong><br>${distances}
    <hr>
    <strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</strong><br>
    ${area.toFixed(2)} Ù…Â²<br>
    ${hectares.toFixed(2)} Ù‡ÙƒØªØ§Ø±<br>
    ${dunum.toFixed(2)} Ø¯ÙˆÙ†Ù…
  `;
}
</script>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¯ 5</title>
<style>
body { font-family: Tahoma; padding:20px }
button { margin:2px }
</style>
</head>

<body>

<h3>Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø¢Ø¨Ø§Ø±</h3>

<div id="wellsContainer"></div>

<button onclick="addWell()">+ Ø¥Ø¶Ø§ÙØ© Ø¨Ø¦Ø±</button>

<script>
let wells = [];

// ØªØ­Ù…ÙŠÙ„
window.onload = function () {
  const saved = localStorage.getItem("wells_test");
  wells = saved ? JSON.parse(saved) : [];
  renderWells();
};

function saveWells() {
  localStorage.setItem("wells_test", JSON.stringify(wells));
}

function addWell() {
  wells.push({ lat:"", lng:"" });
  saveWells();
  renderWells();
}

function removeWell(i) {
  wells.splice(i,1);
  saveWells();
  renderWells();
}

function updateWell(i, f, v) {
  wells[i][f] = v;
  saveWells();
}

function locateWell(i) {
  navigator.geolocation.getCurrentPosition(p=>{
    wells[i].lat = p.coords.latitude.toFixed(6);
    wells[i].lng = p.coords.longitude.toFixed(6);
    saveWells();
    renderWells();
  });
}

function openWellMap(i) {
  const w = wells[i];
  if(!w.lat||!w.lng){ alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª"); return; }
  window.open(`https://www.google.com/maps?q=${w.lat},${w.lng}`);
}

function renderWells() {
  const c = document.getElementById("wellsContainer");
  c.innerHTML = "";
  wells.forEach((w,i)=>{
    c.innerHTML += `
      <div>
        Lat <input value="${w.lat}" oninput="updateWell(${i},'lat',this.value)">
        Lng <input value="${w.lng}" oninput="updateWell(${i},'lng',this.value)">
        <button onclick="locateWell(${i})">ğŸ“</button>
        <button onclick="openWellMap(${i})">ğŸ—ºï¸</button>
        <button onclick="removeWell(${i})">âˆ’</button>
      </div>
    `;
  });
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</title>
<style>
  body { font-family: Arial; direction: rtl; padding: 15px; }
  .box { border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
  input, select, button { margin: 3px; }
</style>
</head>
<body>

<h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ</h3>

<div id="irrigationContainer"></div>

<button onclick="addIrrigation()">+ Ø¥Ø¶Ø§ÙØ© Ù†Ø¸Ø§Ù… Ø±ÙŠ</button>

<script>
/* ===== Ø¨Ù†Ø¯ 6 : Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙŠ ===== */

let irrigations = [];

// ØªØ­Ù…ÙŠÙ„
document.addEventListener("DOMContentLoaded", () => {
  irrigations = JSON.parse(localStorage.getItem("irrigations")) || [];
  renderIrrigation();
});

// Ø­ÙØ¸
function saveIrrigation() {
  localStorage.setItem("irrigations", JSON.stringify(irrigations));
}

// Ø¥Ø¶Ø§ÙØ©
function addIrrigation() {
  irrigations.push({
    type: "",
    towers: 0,
    towerLength: 50,
    crop: "",
    cropNote: ""
  });
  saveIrrigation();
  renderIrrigation();
}

// Ø­Ø°Ù
function removeIrrigation(i) {
  irrigations.splice(i, 1);
  saveIrrigation();
  renderIrrigation();
}

// ØªØ­Ø¯ÙŠØ«
function updateIrrigation(i, field, val) {
  irrigations[i][field] = val;
  saveIrrigation();
  renderIrrigation();
}

// Ø¹Ø±Ø¶
function renderIrrigation() {
  const c = document.getElementById("irrigationContainer");
  c.innerHTML = "";

  irrigations.forEach((r, i) => {

    const totalLength = (Number(r.towers) || 0) * (Number(r.towerLength) || 0);
    const areaM = totalLength * 50; // Ø§ÙØªØ±Ø§Ø¶ Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø±Ø¬ 50Ù…
    const ha = areaM / 10000;
    const dunam = areaM / 1000;

    c.innerHTML += `
      <div class="box">
        Ù†ÙˆØ¹ Ø§Ù„Ø±ÙŠ:
        <select onchange="updateIrrigation(${i},'type',this.value)">
          <option value="">â€”</option>
          <option ${r.type=="Ø±Ø´Ø§Ø´"?"selected":""}>Ø±Ø´Ø§Ø´</option>
          <option ${r.type=="ØªÙ†Ù‚ÙŠØ·"?"selected":""}>ØªÙ†Ù‚ÙŠØ·</option>
          <option ${r.type=="ØºÙ…Ø±"?"selected":""}>ØºÙ…Ø±</option>
        </select>

        <br>
        Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬:
        <input type="number" value="${r.towers}"
          oninput="updateIrrigation(${i},'towers',this.value)">

        Ø·ÙˆÙ„ Ø§Ù„Ø¨Ø±Ø¬:
        <input type="number" value="${r.towerLength}" readonly>

        <br>
        Ø§Ù„Ù…Ø­ØµÙˆÙ„:
        <select onchange="updateIrrigation(${i},'crop',this.value)">
          <option value="">â€”</option>
          <option ${r.crop=="Ù‚Ù…Ø­"?"selected":""}>Ù‚Ù…Ø­</option>
          <option ${r.crop=="Ø£Ø¹Ù„Ø§Ù Ø®Ø¶Ø±Ù‡"?"selected":""}>Ø£Ø¹Ù„Ø§Ù Ø®Ø¶Ø±Ù‡</option>
          <option ${r.crop=="Ø¢Ø®Ø±"?"selected":""}>Ø¢Ø®Ø±</option>
        </select>

        ${(r.crop=="Ø£Ø¹Ù„Ø§Ù Ø®Ø¶Ø±Ù‡" || r.crop=="Ø¢Ø®Ø±") ? `
          <br>
          Ø§Ù„ØªÙØ§ØµÙŠÙ„:
          <input placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†ÙˆØ¹"
            value="${r.cropNote}"
            oninput="updateIrrigation(${i},'cropNote',this.value)">
        ` : ""}

        <hr>
        Ø§Ù„Ø·ÙˆÙ„ Ø§Ù„ÙƒÙ„ÙŠ: <b>${totalLength}</b> Ù…<br>
        Ø§Ù„Ù…Ø³Ø§Ø­Ø©:
        <b>${areaM.toFixed(2)}</b> Ù…Â² |
        <b>${ha.toFixed(2)}</b> Ù‡ÙƒØªØ§Ø± |
        <b>${dunam.toFixed(2)}</b> Ø¯ÙˆÙ†Ù…

        <br><br>
        <button onclick="removeIrrigation(${i})">âˆ’ Ø­Ø°Ù</button>
      </div>
    `;
  });
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¨Ù†Ø¯ 7 - Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</title>
<style>
  body { font-family: Arial; direction: rtl; padding: 15px; }
  .box {
    border: 1px solid #ccc;
    padding: 10px;
    margin-bottom: 10px;
    background: #fafafa;
  }
  input, select, button {
    margin: 4px;
    padding: 4px;
  }
</style>
</head>
<body>

<h3>Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª</h3>

<div id="cropsContainer"></div>

<button onclick="addCrop()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±ÙˆØ¹</button>

<script>
/* ===== Ø¨Ù†Ø¯ 7 : Ø§Ù„Ù…Ø²Ø±ÙˆØ¹Ø§Øª ===== */

let crops = [];

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
document.addEventListener("DOMContentLoaded", () => {
  crops = JSON.parse(localStorage.getItem("crops")) || [];
  renderCrops();
});

// Ø­ÙØ¸
function saveCrops() {
  localStorage.setItem("crops", JSON.stringify(crops));
}

// Ø¥Ø¶Ø§ÙØ©
function addCrop() {
  crops.push({
    type: "",
    otherType: "",
    count: ""
  });
  saveCrops();
  renderCrops();
}

// Ø­Ø°Ù
function removeCrop(i) {
  crops.splice(i, 1);
  saveCrops();
  renderCrops();
}

// ØªØ­Ø¯ÙŠØ«
function updateCrop(i, field, val) {
  crops[i][field] = val;
  saveCrops();
  renderCrops();
}

// Ø¹Ø±Ø¶
function renderCrops() {
  const c = document.getElementById("cropsContainer");
  c.innerHTML = "";

  crops.forEach((r, i) => {

    const count = Number(r.count) || 0;
    const areaM = count * 10; // 10 Ù…Â² Ù„ÙƒÙ„ Ø´ØªÙ„Ø©
    const areaH = areaM / 10000;
    const areaD = areaM / 1000;

    c.innerHTML += `
      <div class="box">

        Ù†ÙˆØ¹ Ø§Ù„Ù…Ø²Ø±ÙˆØ¹:
        <select onchange="updateCrop(${i},'type',this.value)">
          <option value="">â€”</option>
          <option ${r.type=="Ù†Ø®ÙŠÙ„"?"selected":""}>Ù†Ø®ÙŠÙ„</option>
          <option ${r.type=="Ù…ØµØ¯Ø§Øª Ø±ÙŠØ§Ø­"?"selected":""}>Ù…ØµØ¯Ø§Øª Ø±ÙŠØ§Ø­</option>
          <option ${r.type=="Ø­Ù…Ø¶ÙŠØ§Øª"?"selected":""}>Ø­Ù…Ø¶ÙŠØ§Øª</option>
          <option ${r.type=="Ø¢Ø®Ø±"?"selected":""}>Ø¢Ø®Ø±</option>
        </select>

        ${r.type=="Ø¢Ø®Ø±" ? `
          <br>
          Ù†ÙˆØ¹ Ø¢Ø®Ø±:
          <input
            placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†ÙˆØ¹"
            value="${r.otherType}"
            oninput="updateCrop(${i},'otherType',this.value)">
        ` : ""}

        <br>
        Ø¹Ø¯Ø¯ Ø§Ù„Ø´ØªÙ„Ø§Øª:
        <input type="number"
          value="${r.count}"
          oninput="updateCrop(${i},'count',this.value)">

        <hr>
        Ø§Ù„Ù…Ø³Ø§Ø­Ø© (Ø­Ø³Ø§Ø¨ Ø¢Ù„ÙŠ):

        <br>
        ${areaM.toFixed(2)} Ù…Â² |
        ${areaH.toFixed(4)} Ù‡ÙƒØªØ§Ø± |
        ${areaD.toFixed(3)} Ø¯ÙˆÙ†Ù…

        <br><br>
        <button onclick="removeCrop(${i})">âˆ’ Ø­Ø°Ù</button>
      </div>
    `;
  });
}
</script>

</body>
</html>

<h3>Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª</h3>

<div id="assetsContainer"></div>
<button onclick="addAsset()">+ Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¬ÙˆØ¯</button>

<script>
/* ===== Ø¨Ù†Ø¯ 8 : Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø§Øª ===== */

let assets = [];

document.addEventListener("DOMContentLoaded", () => {
  assets = JSON.parse(localStorage.getItem("assets")) || [];
  renderAssets();
});

function saveAssets() {
  localStorage.setItem("assets", JSON.stringify(assets));
}

function addAsset() {
  assets.push({
    mainType: "",
    subType: "",
    otherText: "",
    count: "",
    notes: ""
  });
  saveAssets();
  renderAssets();
}

function removeAsset(i) {
  assets.splice(i, 1);
  saveAssets();
  renderAssets();
}

// ØªØ­Ø¯ÙŠØ« Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù…
function updateAsset(i, field, val) {
  assets[i][field] = val;
  saveAssets();
}

// ØªØ­Ø¯ÙŠØ« Ù…Ø¹ Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… (Ù„Ù„Ù‚ÙˆØ§Ø¦Ù… ÙÙ‚Ø·)
function updateAssetAndRender(i, field, val) {
  assets[i][field] = val;

  // ØªØµÙÙŠØ± Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„ØªØ§Ø¨Ø¹Ø©
  if (field === "mainType") {
    assets[i].subType = "";
    assets[i].otherText = "";
  }
  if (field === "subType") {
    assets[i].otherText = "";
  }

  saveAssets();
  renderAssets();
}

function renderAssets() {
  const c = document.getElementById("assetsContainer");
  c.innerHTML = "";

  assets.forEach((a, i) => {
    c.innerHTML += `
      <div style="border:1px solid #ccc; padding:10px; margin-bottom:10px">

        Ù†ÙˆØ¹ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯:
        <select onchange="updateAssetAndRender(${i},'mainType',this.value)">
          <option value="">â€”</option>
          <option ${a.mainType=="Ù…Ø¨Ø§Ù†ÙŠ"?"selected":""}>Ù…Ø¨Ø§Ù†ÙŠ</option>
          <option ${a.mainType=="Ø®Ø²Ø§Ù†Ø§Øª"?"selected":""}>Ø®Ø²Ø§Ù†Ø§Øª</option>
          <option ${a.mainType=="Ù…ÙˆÙ„Ø¯Ø§Øª"?"selected":""}>Ù…ÙˆÙ„Ø¯Ø§Øª</option>
          <option ${a.mainType=="Ø£Ø®Ø±Ù‰"?"selected":""}>Ø£Ø®Ø±Ù‰</option>
        </select>

        ${a.mainType=="Ù…Ø¨Ø§Ù†ÙŠ" ? `
          <br>
          Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¨Ù†Ù‰:
          <select onchange="updateAssetAndRender(${i},'subType',this.value)">
            <option value="">â€”</option>
            <option ${a.subType=="Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª"?"selected":""}>Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª</option>
            <option ${a.subType=="Ø³ÙƒÙ† Ø¹Ù…Ø§Ù„"?"selected":""}>Ø³ÙƒÙ† Ø¹Ù…Ø§Ù„</option>
            <option ${a.subType=="Ø§Ø³ØªØ±Ø§Ø­Ø©"?"selected":""}>Ø§Ø³ØªØ±Ø§Ø­Ø©</option>
            <option ${a.subType=="Ø¢Ø®Ø±"?"selected":""}>Ø¢Ø®Ø±</option>
          </select>
        ` : ""}

        ${a.mainType=="Ù…ÙˆÙ„Ø¯Ø§Øª" ? `
          <br>
          Ù†ÙˆØ¹ Ø§Ù„Ù…ÙˆÙ„Ø¯:
          <select onchange="updateAsset(${i},'subType',this.value)">
            <option value="">â€”</option>
            <option ${a.subType=="Ø±Ø§Ø³ ÙƒÙ‡Ø±Ø¨"?"selected":""}>Ø±Ø§Ø³ ÙƒÙ‡Ø±Ø¨</option>
            <option ${a.subType=="ØºØ·Ø§Ø³"?"selected":""}>ØºØ·Ø§Ø³</option>
            <option ${a.subType=="Ù…ÙƒÙ†ÙŠÙ‡+ØºØ·Ø§Ø³"?"selected":""}>Ù…ÙƒÙ†ÙŠÙ‡ + ØºØ·Ø§Ø³</option>
          </select>
        ` : ""}

        ${(a.mainType=="Ø£Ø®Ø±Ù‰" || a.subType=="Ø¢Ø®Ø±") ? `
          <br>
          Ø§Ù„ÙˆØµÙ:
          <input
            placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ØªÙØ§ØµÙŠÙ„"
            value="${a.otherText}"
            oninput="updateAsset(${i},'otherText',this.value)">
        ` : ""}

        <br>
        Ø§Ù„Ø¹Ø¯Ø¯:
        <input type="number"
          value="${a.count}"
          oninput="updateAsset(${i},'count',this.value)">

        <br>
        Ù…Ù„Ø§Ø­Ø¸Ø§Øª:
        <textarea rows="2"
          oninput="updateAsset(${i},'notes',this.value)">${a.notes}</textarea>

        <br><br>
        <button onclick="removeAsset(${i})">âˆ’ Ø­Ø°Ù</button>

      </div>
    `;
  });
}
</script>

<h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø­Ø«</h3>

<div style="border:1px solid #ccc; padding:10px; margin-bottom:15px">

  Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«:
  <input type="text" id="researcherName"
    placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«"
    style="width:60%"
    oninput="saveResearcher()">

</div>

<div style="margin-bottom:20px">
  <button onclick="saveAll()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
  <button onclick="clearAll()">ğŸ—‘ï¸ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
  <button onclick="printPage()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© PDF</button>
</div>

<script>
/* ===== Ø¨Ù†Ø¯ 9 : Ø§Ù„Ø¨Ø§Ø­Ø« + Ø§Ù„Ø­ÙØ¸ + Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ===== */

// ØªØ­Ù…ÙŠÙ„ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«
document.addEventListener("DOMContentLoaded", () => {
  const name = localStorage.getItem("researcherName");
  if (name) {
    document.getElementById("researcherName").value = name;
  }
});

// Ø­ÙØ¸ Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø­Ø«
function saveResearcher() {
  const name = document.getElementById("researcherName").value;
  localStorage.setItem("researcherName", name);
}

// Ø­ÙØ¸ ÙŠØ¯ÙˆÙŠ Ø´Ø§Ù…Ù„
function saveAll() {
  saveResearcher();
  alert("ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ âœ…");
}

// Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø¨Ù‚Ø±Ø§Ø± Ù…Ù†Ùƒ)
function clearAll() {
  if (!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒØ´ÙØŸ")) return;
  localStorage.clear();
  location.reload();
}

// Ø·Ø¨Ø§Ø¹Ø©
function printPage() {
  window.print();
}
</script>